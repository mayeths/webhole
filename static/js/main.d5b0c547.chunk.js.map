{"version":3,"sources":["color_picker.js","text_splitter.js","infrastructure/const.js","infrastructure/functions.js","infrastructure/widgets.js","cache.js","flows_api.js","Markdown.js","Common.js","react-lazyload/src/utils/event.js","react-lazyload/src/utils/scrollParent.js","react-lazyload/src/index.jsx","react-lazyload/src/utils/debounce.js","react-lazyload/src/utils/throttle.js","AudioWidget.js","Message.js","Config.js","UserAction.js","Flows.js","Title.js","Sidebar.js","PressureHelper.js","App.js","registerServiceWorker.js","index.js","infrastructure/appicon/hole.png","infrastructure/appicon/imasugu.png","infrastructure/appicon/imasugu_rev.png","infrastructure/appicon/syllabus.png","infrastructure/appicon/score.png","infrastructure/appicon/course_survey.png","infrastructure/appicon/homepage.png","infrastructure/appicon/dropdown.png","infrastructure/appicon/dropdown_rev.png"],"names":["ColorPicker","this","names","current_h","Math","random","name","toLowerCase","PID_RE","URL_PID_RE","NICKNAME_RE","URL_RE","split_text","txt","rules","forEach","rule","regex","concat","apply","map","part","content","split","seg","test","filter","THUHOLE_API_ROOT","get_json","res","ok","Error","status","statusText","text","then","t","JSON","parse","e","console","error","trace","log","SyntaxError","substr","API_VERSION_PARAM","encodeURIComponent","process","REACT_APP_BUILD_INFO","floor","Date","pad2","x","format_time","time","getMonth","getDate","getHours","getMinutes","getSeconds","chinese_format","buildFormatter","chineseStrings","Time","props","stamp","className","date","formatter","title","toLocaleString","timeZone","hour12","short","TitleLine","appicon_hole","appicon_imasugu","appicon_imasugu_rev","appicon_syllabus","appicon_score","appicon_course_survey","appicon_homepage","LoginPopupSelf","state","loading_status","recaptcha_verified","username_ref","React","createRef","password_ref","input_token_ref","popup_anchor","document","getElementById","createElement","id","body","appendChild","type","setState","fetch","current","value","localStorage","method","headers","stringify","excluded_scopes","json","success","alert","msg","catch","set_token","code","user_token","on_close","token","result","length","ReactDOM","createPortal","reCaptchaKey","useRecaptchaNet","onVerify","ref","autoFocus","defaultValue","onClick","do_sendcode","disabled","do_login","token_callback","placeholder","do_input_token","style","fontSize","href","Component","LoginPopup","popup_show","on_popup_bound","on_popup","bind","on_close_bound","children","Cache","db","added_items_since_maintenance","encrypt","decrypt","open_req","indexedDB","open","onerror","onupgradeneeded","event","target","createObjectStore","keyPath","createIndex","unique","onsuccess","setTimeout","maintenance","pid","data","s","o","i","key","new_key","charCodeAt","String","fromCharCode","c","target_version","parseInt","Promise","resolve","reject","get_req","store","tx","transaction","objectStore","get","exception","data_str","version","last_access","put","delete","warn","req","count_req","count","index","openKeyCursor","cur","primaryKey","continue","deleteDatabase","cache","window","hole_cache","token_param","handle_response","response","a","notify","parse_replies","replies","color_picker","sort","b","cid","info","_display_color","variant","API","load_replies","cache_version","API_BASE","load_replies_with_cache","cached","set_attention","attention","URLSearchParams","append","report","reason","get_list","page","get_search","keyword","get_single","get_attention","md","MarkdownIt","html","linkify","breaks","inline","highlight","str","lang","hljs","getLanguage","__","utils","escapeHtml","use","MarkdownItKaTeX","throwOnError","errorColor","render","escape_regex","string","replace","build_highlight_re","option","isRegex","RegExp","join","slice","ColoredSpan","colors","normalize_url","url","PureComponent","HighlightedMarkdown","processInstructions","shouldProcessNode","node","processNode","currentLevel","HeadingTag","attribs","rel","parent","splitted","Fragment","idx","p","preventDefault","show_pid","substring","HtmlToReact","ProcessNodeDefinitions","processDefaultNode","parser","Parser","author","match","renderedMarkdown","renderMd","parseWithInstructions","rawMd","TEXTAREA_BACKUP","SafeTextarea","on_change_bound","on_change","on_keydown_bound","on_keydown","clear","area_ref","change_callback","submit_callback","on_submit","ctrlKey","altKey","focus","onChange","onKeyDown","pwa_prompt_event","PromotionBar","is_ios","navigator","userAgent","matchMedia","matches","standalone","prompt","addEventListener","ClickHandler","moved","init_y","init_x","on_begin_bound","on_begin","on_move_bound","on_move","on_end_bound","on_end","MOVE_THRESHOLD","last_fire","touches","screenY","screenX","abs","do_callback","callback","onTouchStart","onMouseDown","onTouchMove","onMouseMove","on","el","eventName","opts","attachEvent","call","off","removeEventListener","detachEvent","HTMLElement","documentElement","excludeStaticParent","position","overflowRegex","parentNode","ownerDocument","getComputedStyle","overflow","overflowX","overflowY","defaultBoundingClientRect","LISTEN_FLAG","listeners","pending","passiveEventSupported","Object","defineProperty","delayType","passiveEvent","capture","passive","checkVisible","component","ReactDom","findDOMNode","scrollParent","parentTop","parentHeight","getBoundingClientRect","top","height","windowInnerHeight","innerHeight","clientHeight","intersectionTop","max","intersectionHeight","min","offsetTop","offsets","Array","isArray","offset","checkOverflowVisible","elementHeight","offsetWidth","offsetHeight","getClientRects","checkNormalVisible","visible","hidden","once","push","unmountIfInvisible","hiddenIfInvisible","lazyLoadHandler","listener","indexOf","splice","finalLazyLoadHandler","LazyLoad","scrollport","scrollContainer","querySelector","needResetFinalLazyLoadHandler","undefined","debounce","func","wait","immediate","timeout","args","context","timestamp","later","last","arguments","callNow","throttle","fn","threshhold","scope","deferTimer","now","clearTimeout","getAttribute","listenerCount","setAttribute","scroll","resize","removeAttribute","visibility","defaultProps","audio_cache","MessageViewer","load","err","BUILTIN_IMGS","DEFAULT_CONFIG","background_img","background_color","pressure","easter_egg","color_scheme","fold","block_words","load_config","loaded_config","config","assign","keys","save_config","bgimg_style","img","color","background","backgroundImage","encodeURI","backgroundColor","backgroundSize","ConfigBackground","save_changes","img_select","on_select","on_change_img","on_change_color","ConfigColorScheme","ConfigTextArea","sift","description","display","ConfigSwitch","switch","val","checked","ConfigUI","save_changes_bound","chg","confirm","location","reload","reset_settings","array","v","TokenCtx","createContext","set_value","InfoSidebar","show_sidebar","serviceWorker","getRegistrations","registrations","registration","unregister","LoginForm","copy","Consumer","copy_token","do_popup","PostForm","img_tip","preview","img_ref","on_img_change_bound","on_img_change","global_keypress_handler_bound","global_keypress_handler","tagName","action","on_complete","file","return_url","reader","FileReader","onload","fixOrientation","fixed_dataurl","image","Image","width","compressed","rate","sqrt","canvas","ctx","getContext","drawImage","quality","new_url","quality_l","quality_r","toDataURL","round","src","on_got_img","readAsDataURL","files","proc_img","d","includes","do_post","replyClassName","onSubmit","accept","toggle_preview","IMAGE_BASE","IMAGE_BAK_BASE","CLICKABLE_TAGS","audio","QUOTE_BLACKLIST","FOLD_TAGS","LATEST_POST_ID","load_single_meta","title_elem","single","reply","deletion_detect","Reply","replyContent","splitIdx","replyText","do_filter_name","tag","img_clickable","onError","alt","FlowItem","likenum","r","is_quote","copy_link","latest_reply","FlowSidebar","error_msg","filter_name","rev","syncState","sync_state","reply_ref","prev","update_count","set_variant","next_attention","prevState","forceCheck","closest","should_text","set","replies_to_show","reverse","replies_cnt","main_thread_elem","show_reply_bar","set_filter_name","toggle_rev","toggle_attention","float","FlowItemRow","needFold","search_param","mode","reply_status","reply_error","some","word","attention_override","hl_rules","parts","quote_id","FlowItemQuote","FlowChunk","list","ind","Flow","search_text","loaded_pages","chunks","on_scroll_bound","on_scroll","failed","max_id","finished","use_search","use_regex","regex_search","toString","post","every","scrollHeight","scrollY","load_page","should_deletion_detect","flag_re","ControlBar","set_mode","on_keypress_bound","on_keypress","do_refresh_bound","do_refresh","do_attention_bound","do_attention","hash","decodeURIComponent","lastIndexOf","flag_res","exec","startsWith","scrollTo","onKeyPress","Title","Sidebar","do_close_bound","do_close","do_back_bound","do_back","contents","stack","cur_title","onTouchEnd","click","PressureHelper","level","fired","esc_interval","clearInterval","Pressure","change","force","do_fire","end","polyfill","only","preventSelect","repeat","THRESHOLD","setInterval","new_level","pad","left","right","bottom","DeprecatedAlert","App","override","update_color_scheme","classList","add","remove","addListener","listen_darkmode","default","light","dark","sidebar_stack","flow_render_key","show_sidebar_bound","set_mode_bound","on_pressure_bound","on_pressure","inthu_flag","atob","ns","pop","Provider","isLocalhost","Boolean","hostname","registerValidSW","swUrl","register","onupdatefound","installingWorker","installing","onstatechange","controller","ready","checkValidServiceWorker","module","exports"],"mappings":"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","file":"static/js/main.d5b0c547.chunk.js","sourcesContent":["// https://martin.ankerl.com/2009/12/09/how-to-create-random-colors-programmatically/\r\n\r\nconst golden_ratio_conjugate = 0.618033988749895;\r\n\r\nexport class ColorPicker {\r\n  constructor() {\r\n    this.names = {};\r\n    this.current_h = Math.random();\r\n  }\r\n\r\n  get(name) {\r\n    name = name.toLowerCase();\r\n    if (name === '洞主') return ['hsl(0,0%,97%)', 'hsl(0,0%,16%)'];\r\n\r\n    if (!this.names[name]) {\r\n      this.current_h += golden_ratio_conjugate;\r\n      this.current_h %= 1;\r\n      this.names[name] = [\r\n        `hsl(${this.current_h * 360}, 50%, 90%)`,\r\n        `hsl(${this.current_h * 360}, 60%, 20%)`,\r\n      ];\r\n    }\r\n    return this.names[name];\r\n  }\r\n}\r\n","// regexp should match the WHOLE segmented part\r\n// export const PID_RE=/(^|[^\\d\\u20e3\\ufe0e\\ufe0f])([2-9]\\d{4,5}|1\\d{4,6})(?![\\d\\u20e3\\ufe0e\\ufe0f])/g;\r\nexport const PID_RE = /(^|[^\\d\\u20e3\\ufe0e\\ufe0f])(#\\d{1,7})(?![\\d\\u20e3\\ufe0e\\ufe0f])/g;\r\n// TODO: fix this re\r\n// export const URL_PID_RE=/((?:https?:\\/\\/)?thuhole\\.com\\/?#(?:#|%23)([2-9]\\d{4,5}|1\\d{4,6}))(?!\\d|\\u20e3|\\ufe0e|\\ufe0f)/g;\r\nexport const URL_PID_RE = /((?:https?:\\/\\/)?thuhole\\.com\\/?#(?:#|%23)(\\d{1,7}))(?!\\d|\\u20e3|\\ufe0e|\\ufe0f)/g;\r\nexport const NICKNAME_RE = /(^|[^A-Za-z])((?:(?:Angry|Baby|Crazy|Diligent|Excited|Fat|Greedy|Hungry|Interesting|Jolly|Kind|Little|Magic|Naïve|Old|PKU|Quiet|Rich|Superman|Tough|Undefined|Valuable|Wifeless|Xiangbuchulai|Young|Zombie)\\s)?(?:Alice|Bob|Carol|Dave|Eve|Francis|Grace|Hans|Isabella|Jason|Kate|Louis|Margaret|Nathan|Olivia|Paul|Queen|Richard|Susan|Thomas|Uma|Vivian|Winnie|Xander|Yasmine|Zach)|You Win(?: \\d+)?|洞主)(?![A-Za-z])/gi;\r\nexport const URL_RE = /(^|[^.@a-zA-Z0-9_])((?:https?:\\/\\/)?(?:(?:[\\w-]+\\.)+[a-zA-Z]{2,3}|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})(?::\\d{1,5})?(?:\\/[\\w~!@#$%^&*()\\-_=+[\\]{};:,./?|]*)?)(?![a-zA-Z0-9])/gi;\r\n\r\nexport function split_text(txt, rules) {\r\n  // rules: [['name',/regex/],...]\r\n  // return: [['name','part'],[null,'part'],...]\r\n\r\n  txt = [[null, txt]];\r\n  rules.forEach((rule) => {\r\n    let [name, regex] = rule;\r\n    txt = [].concat.apply(\r\n      [],\r\n      txt.map((part) => {\r\n        let [rule, content] = part;\r\n        if (rule)\r\n          // already tagged by previous rules\r\n          return [part];\r\n        else {\r\n          return content\r\n            .split(regex)\r\n            .map((seg) => (regex.test(seg) ? [name, seg] : [null, seg]))\r\n            .filter(([name, seg]) => name !== null || seg);\r\n        }\r\n      }),\r\n    );\r\n  });\r\n  return txt;\r\n}\r\n","// export const THUHOLE_API_ROOT='//localhost:5001/';\r\nexport const THUHOLE_API_ROOT = 'https://api.thuhole.com/'\r\n","export function get_json(res) {\r\n    if(!res.ok) throw Error(`网络错误 ${res.status} ${res.statusText}`);\r\n    return (\r\n        res\r\n            .text()\r\n            .then((t)=>{\r\n                try {\r\n                    return JSON.parse(t);\r\n                } catch(e) {\r\n                    console.error('json parse error');\r\n                    console.trace(e);\r\n                    console.log(t);\r\n                    throw new SyntaxError('JSON Parse Error '+t.substr(0,50));\r\n                }\r\n            })\r\n    );\r\n}\r\n\r\nexport function listen_darkmode(override) { // override: true/false/undefined\r\n    function update_color_scheme() {\r\n        if(override===undefined ? window.matchMedia('(prefers-color-scheme: dark)').matches : override)\r\n            document.body.classList.add('root-dark-mode');\r\n        else\r\n            document.body.classList.remove('root-dark-mode');\r\n    }\r\n\r\n    update_color_scheme();\r\n    window.matchMedia('(prefers-color-scheme: dark)').addListener(()=>{\r\n        update_color_scheme();\r\n    });\r\n}\r\n\r\nexport function API_VERSION_PARAM() {\r\n    return '&PKUHelperAPI=3.0&jsapiver='+encodeURIComponent((process.env.REACT_APP_BUILD_INFO||'null')+'-'+(Math.floor(+new Date()/7200000)*2));\r\n}","import React, {Component, PureComponent} from 'react';\r\nimport ReactDOM from 'react-dom';\r\n\r\nimport TimeAgo from 'react-timeago';\r\nimport chineseStrings from 'react-timeago/lib/language-strings/zh-CN';\r\nimport buildFormatter from 'react-timeago/lib/formatters/buildFormatter';\r\n\r\nimport './global.css';\r\nimport './widgets.css';\r\n\r\nimport appicon_hole from './appicon/hole.png';\r\nimport appicon_imasugu from './appicon/imasugu.png';\r\nimport appicon_imasugu_rev from './appicon/imasugu_rev.png';\r\nimport appicon_syllabus from './appicon/syllabus.png';\r\nimport appicon_score from './appicon/score.png';\r\nimport appicon_course_survey from './appicon/course_survey.png';\r\nimport appicon_dropdown from './appicon/dropdown.png';\r\nimport appicon_dropdown_rev from './appicon/dropdown_rev.png';\r\nimport appicon_homepage from './appicon/homepage.png';\r\nimport {THUHOLE_API_ROOT} from './const';\r\nimport {get_json, API_VERSION_PARAM} from './functions';\r\n\r\nimport {\r\n    GoogleReCaptchaProvider,\r\n    GoogleReCaptcha\r\n} from 'react-google-recaptcha-v3';\r\n\r\nconst LOGIN_POPUP_ANCHOR_ID='pkuhelper_login_popup_anchor';\r\n\r\nfunction pad2(x) {\r\n    return x<10 ? '0'+x : ''+x;\r\n}\r\nexport function format_time(time) {\r\n    return `${time.getMonth()+1}-${pad2(time.getDate())} ${time.getHours()}:${pad2(time.getMinutes())}:${pad2(time.getSeconds())}`;\r\n}\r\nconst chinese_format=buildFormatter(chineseStrings);\r\nexport function Time(props) {\r\n    const time=new Date(props.stamp*1000);\r\n    return (\r\n        <span className={\"time-str\"}>\r\n            <TimeAgo date={time} formatter={chinese_format} title={time.toLocaleString('zh-CN', {\r\n                timeZone: 'Asia/Shanghai',\r\n                hour12: false,\r\n            })} />\r\n            &nbsp;\r\n            {!props.short ? format_time(time) : null}\r\n        </span>\r\n    );\r\n}\r\n\r\nexport function TitleLine(props) {\r\n    return (\r\n        <p className=\"centered-line title-line aux-margin\">\r\n            <span className=\"black-outline\">{props.text}</span>\r\n        </p>\r\n    )\r\n}\r\n\r\nexport function GlobalTitle(props) {\r\n    return (\r\n        <div className=\"aux-margin\">\r\n            <div className=\"title\">\r\n                <p className=\"centered-line\">{props.text}</p>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nconst FALLBACK_APPS={\r\n    // id, text, url, icon_normal, icon_hover, new_tab\r\n    bar: [\r\n        ['hole', '树洞', '/hole', appicon_hole, null, false],\r\n        ['imasugu', '教室', '/spare_classroom', appicon_imasugu, appicon_imasugu_rev, false],\r\n        ['syllabus', '课表', '/syllabus', appicon_syllabus, null, false],\r\n        ['score', '成绩', '/my_score', appicon_score, null, false],\r\n    ],\r\n    dropdown: [\r\n        ['course_survey', '课程测评', 'https://courses.pinzhixiaoyuan.com/', appicon_course_survey, null, true],\r\n        ['homepage', '客户端', '/', appicon_homepage, null, true],\r\n    ],\r\n    fix: {},\r\n};\r\n// const SWITCHER_DATA_VER='switcher_2';\r\n// const SWITCHER_DATA_URL=THUHOLE_API_ROOT+'web_static/appswitcher_items.json';\r\n\r\n// export class AppSwitcher extends Component {\r\n//     constructor(props) {\r\n//         super(props);\r\n//         this.state={\r\n//             apps: this.get_apps_from_localstorage(),\r\n//         }\r\n//     }\r\n//\r\n//     get_apps_from_localstorage() {\r\n//         let ret=FALLBACK_APPS;\r\n//         if(localStorage['APPSWITCHER_ITEMS'])\r\n//             try {\r\n//                 let content=JSON.parse(localStorage['APPSWITCHER_ITEMS'])[SWITCHER_DATA_VER];\r\n//                 if(!content || !content.bar)\r\n//                     throw new Error('content is empty');\r\n//\r\n//                 ret=content;\r\n//             } catch(e) {\r\n//                 console.error('load appswitcher items from localstorage failed');\r\n//                 console.trace(e);\r\n//             }\r\n//\r\n//         return ret;\r\n//     }\r\n//\r\n//     check_fix() {\r\n//         if(this.state.apps && this.state.apps.fix && this.state.apps.fix[this.props.appid])\r\n//             setTimeout(()=>{\r\n//                 window.HOTFIX_CONTEXT={\r\n//                     build_info: process.env.REACT_APP_BUILD_INFO || '---',\r\n//                     build_env: process.env.NODE_ENV,\r\n//                 };\r\n//                 eval(this.state.apps.fix[this.props.appid]);\r\n//             },1); // make it async so failures won't be critical\r\n//     }\r\n//\r\n//     componentDidMount() {\r\n//         this.check_fix();\r\n//         setTimeout(()=>{\r\n//             fetch(SWITCHER_DATA_URL)\r\n//                 .then((res)=>{\r\n//                     if(!res.ok) throw Error(`网络错误 ${res.status} ${res.statusText}`);\r\n//                     return res.text();\r\n//                 })\r\n//                 .then((txt)=>{\r\n//                     if(txt!==localStorage['APPSWITCHER_ITEMS']) {\r\n//                         console.log('loaded new appswitcher items',txt);\r\n//                         localStorage['APPSWITCHER_ITEMS']=txt;\r\n//\r\n//                         this.setState({\r\n//                             apps: this.get_apps_from_localstorage(),\r\n//                         });\r\n//                     } else {\r\n//                         console.log('appswitcher items unchanged');\r\n//                     }\r\n//                 })\r\n//                 .catch((e)=>{\r\n//                     console.error('loading appswitcher items failed');\r\n//                     console.trace(e);\r\n//                 });\r\n//         },500);\r\n//     }\r\n//\r\n//     componentDidUpdate(prevProps, prevState) {\r\n//         if(this.state.apps!==prevState.apps)\r\n//             this.check_fix();\r\n//     }\r\n//\r\n//     render() {\r\n//         let cur_id=this.props.appid;\r\n//\r\n//         function app_elem([id,title,url,icon_normal,icon_hover,new_tab],no_class=false,ref=null) {\r\n//             return (\r\n//                 <a ref={ref} key={id} className={no_class ? null : ('app-switcher-item'+(id===cur_id ? ' app-switcher-item-current' : ''))}\r\n//                    href={url} target={new_tab ? '_blank' : '_self'}>\r\n//                     {!!icon_normal && [\r\n//                         <img key=\"normal\" src={icon_normal} className=\"app-switcher-logo-normal\" />,\r\n//                         <img key=\"hover\" src={icon_hover||icon_normal} className=\"app-switcher-logo-hover\" />\r\n//                     ]}\r\n//                     <span>{title}</span>\r\n//                 </a>\r\n//             );\r\n//         }\r\n//\r\n//         let dropdown_cur_app=null;\r\n//         this.state.apps.dropdown.forEach((app)=>{\r\n//             if(app[0]===cur_id)\r\n//                 dropdown_cur_app=app;\r\n//         });\r\n//\r\n//         //console.log(JSON.stringify(this.state.apps));\r\n//\r\n//         return (\r\n//             <div className=\"app-switcher\">\r\n//                 <span className=\"app-switcher-desc app-switcher-left\">PKUHelper</span>\r\n//                 {this.state.apps.bar.map((app)=>\r\n//                     app_elem(app)\r\n//                 )}\r\n//                 {!!this.state.apps.dropdown.length &&\r\n//                     <div className={\r\n//                         'app-switcher-item app-switcher-dropdown '\r\n//                         +(dropdown_cur_app ? ' app-switcher-item-current' : '')\r\n//                     }>\r\n//                         <p className=\"app-switcher-dropdown-title\">\r\n//                             {!!dropdown_cur_app ?\r\n//                                 app_elem((()=>{\r\n//                                     let [id,title,_url,icon_normal,icon_hover,_new_tab]=dropdown_cur_app;\r\n//                                     return [id,title+'▾',null,icon_normal,icon_hover,false];\r\n//                                 })(),true) :\r\n//                                 app_elem(['-placeholder-elem','更多▾',null,appicon_dropdown,appicon_dropdown_rev,false],true)\r\n//                             }\r\n//                         </p>\r\n//                         {this.state.apps.dropdown.map((app)=>{\r\n//                             let ref=React.createRef();\r\n//                             return (\r\n//                                 <p key={app[0]} className=\"app-switcher-dropdown-item\" onClick={(e)=>{\r\n//                                     if(!e.target.closest('a') && ref.current)\r\n//                                         ref.current.click();\r\n//                                 }}>\r\n//                                     {app_elem(app,true,ref)}\r\n//                                 </p>\r\n//                             );\r\n//                         })}\r\n//                     </div>\r\n//                 }\r\n//                 <span className=\"app-switcher-desc app-switcher-right\">网页版</span>\r\n//             </div>\r\n//         );\r\n//     }\r\n// }\r\n\r\nclass LoginPopupSelf extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state={\r\n            loading_status: 'idle',\r\n            recaptcha_verified: false\r\n            // excluded_scopes: [],\r\n        };\r\n        this.username_ref=React.createRef();\r\n        this.password_ref=React.createRef();\r\n        this.input_token_ref=React.createRef();\r\n\r\n        this.popup_anchor=document.getElementById(LOGIN_POPUP_ANCHOR_ID);\r\n        if(!this.popup_anchor) {\r\n            this.popup_anchor=document.createElement('div');\r\n            this.popup_anchor.id=LOGIN_POPUP_ANCHOR_ID;\r\n            document.body.appendChild(this.popup_anchor);\r\n        }\r\n    }\r\n\r\n    do_sendcode(type) {\r\n        if(!this.state.recaptcha_verified) {\r\n            alert(\"reCAPTCHA风控系统正在评估您的浏览器安全状态，请稍后重试。\")\r\n            return\r\n        }\r\n        if(this.state.loading_status==='loading')\r\n            return;\r\n\r\n        this.setState({\r\n            loading_status: 'loading',\r\n        },()=>{\r\n            fetch(\r\n                THUHOLE_API_ROOT+'api_xmcp/login/send_code'\r\n                +'?user='+encodeURIComponent(this.username_ref.current.value)\r\n                +'&code_type='+encodeURIComponent(type)\r\n                +\"&recaptcha_token=\"+localStorage[\"recaptcha\"]\r\n                +API_VERSION_PARAM(), {\r\n                    method: 'POST',\r\n                    headers: {\r\n                        'Content-Type': 'application/json',\r\n                    },\r\n                    body: JSON.stringify({\r\n                        excluded_scopes: [],\r\n                    }),\r\n                }\r\n            )\r\n                .then(get_json)\r\n                .then((json)=>{\r\n                    console.log(json);\r\n                    if(!json.success)\r\n                        throw new Error(JSON.stringify(json));\r\n\r\n                    alert(json.msg);\r\n                    this.setState({\r\n                        loading_status: 'done',\r\n                    });\r\n                })\r\n                .catch((e)=>{\r\n                    console.error(e);\r\n                    alert('发送失败\\n'+e);\r\n                    this.setState({\r\n                        loading_status: 'done',\r\n                    });\r\n                });\r\n\r\n        });\r\n    }\r\n\r\n    do_login(set_token) {\r\n        if(this.state.loading_status==='loading')\r\n            return;\r\n\r\n        this.setState({\r\n            loading_status: 'loading',\r\n        },()=>{\r\n            fetch(\r\n                THUHOLE_API_ROOT+'api_xmcp/login/login'\r\n                +'?user='+encodeURIComponent(this.username_ref.current.value)\r\n                +'&valid_code='+encodeURIComponent(this.password_ref.current.value)\r\n                +API_VERSION_PARAM(), {\r\n                    method: 'POST',\r\n                    headers: {\r\n                        'Content-Type': 'application/json',\r\n                    },\r\n                    body: JSON.stringify({\r\n                        excluded_scopes: [],\r\n                    }),\r\n                }\r\n            )\r\n                .then(get_json)\r\n                .then((json)=>{\r\n                    if(json.code!==0) {\r\n                        if(json.msg) throw new Error(json.msg);\r\n                        throw new Error(JSON.stringify(json));\r\n                    }\r\n\r\n                    set_token(json.user_token);\r\n                    alert(`登录成功`);\r\n                    this.setState({\r\n                        loading_status: 'done',\r\n                    });\r\n                    this.props.on_close();\r\n                })\r\n                .catch((e)=>{\r\n                    console.error(e);\r\n                    alert('登录失败\\n'+e);\r\n                    this.setState({\r\n                        loading_status: 'done',\r\n                    });\r\n                });\r\n        });\r\n    }\r\n\r\n    do_input_token(set_token) {\r\n        if(this.state.loading_status==='loading')\r\n            return;\r\n\r\n        let token=this.input_token_ref.current.value;\r\n        this.setState({\r\n            loading_status: 'loading',\r\n        },()=>{\r\n            fetch(THUHOLE_API_ROOT+'api_xmcp/hole/system_msg?user_token='+encodeURIComponent(token)+API_VERSION_PARAM())\r\n                .then((res)=>res.json())\r\n                .then((json)=>{\r\n                    if(json.error)\r\n                        throw new Error(json.error);\r\n                    if(json.result.length===0)\r\n                        throw new Error('result check failed');\r\n                    this.setState({\r\n                        loading_status: 'done',\r\n                    });\r\n                    set_token(token);\r\n                    this.props.on_close();\r\n                })\r\n                .catch((e)=>{\r\n                    alert('Token检验失败\\n'+e);\r\n                    this.setState({\r\n                        loading_status: 'done',\r\n                    });\r\n                    console.error(e);\r\n                });\r\n        });\r\n    }\r\n\r\n    // perm_alert() {\r\n    //     alert('如果你不需要 PKU Helper 的某项功能，可以取消相应权限。\\n其中【状态信息】包括你的网费、校园卡余额等。\\n该设置应用到你的【所有】设备，取消后如需再次启用相应功能需要重新登录。');\r\n    // }\r\n\r\n    render() {\r\n        // let PERM_SCOPES=[\r\n        //     ['score','成绩查询'],\r\n        //     ['syllabus','课表查询'],\r\n        //     ['my_info','状态信息'],\r\n        // ];\r\n\r\n        return ReactDOM.createPortal(\r\n            <GoogleReCaptchaProvider reCaptchaKey={\"6Leq0a0ZAAAAAHEStocsqtJfKEs9APB0LdgzTNfZ\"} useRecaptchaNet={true}>\r\n            <GoogleReCaptcha onVerify={(token) => {\r\n                this.setState({\r\n                    recaptcha_verified: true,\r\n                });\r\n                localStorage[\"recaptcha\"] = token\r\n            }} />\r\n            <div>\r\n                <div className=\"thuhole-login-popup-shadow\" />\r\n                <div className=\"thuhole-login-popup\">\r\n                    <p>\r\n                        <b>接收验证码来登录 T大树洞</b>\r\n                    </p>\r\n                    <p>\r\n                        <label>\r\n                            　邮箱&nbsp;\r\n                            <input ref={this.username_ref} type=\"email\" autoFocus={true} defaultValue=\"@mails.tsinghua.edu.cn\" />\r\n                        </label>\r\n                        <span className=\"thuhole-login-type\">\r\n                                {/*<a onClick={(e)=>this.do_sendcode('sms')}>*/}\r\n                                {/*    &nbsp;短信&nbsp;*/}\r\n                                {/*</a>*/}\r\n                                {/*/*/}\r\n                                <a onClick={(e)=>this.do_sendcode('mail')}>\r\n                                    &nbsp;发送邮件&nbsp;\r\n                                </a>\r\n                            </span>\r\n                    </p>\r\n                    <p>\r\n                        <label>\r\n                            验证码&nbsp;\r\n                            <input ref={this.password_ref} type=\"tel\" />\r\n                        </label>\r\n                        <button type=\"button\" disabled={this.state.loading_status==='loading'}\r\n                                onClick={(e)=>this.do_login(this.props.token_callback)}>\r\n                            登录\r\n                        </button>\r\n                    </p>\r\n                    <hr />\r\n                    <p>\r\n                        <b>从其他设备导入登录状态</b>\r\n                    </p>\r\n                    <p>\r\n                        <input ref={this.input_token_ref} placeholder=\"User Token\" />\r\n                        <button type=\"button\" disabled={this.state.loading_status==='loading'}\r\n                                onClick={(e)=>this.do_input_token(this.props.token_callback)}>\r\n                            导入\r\n                        </button>\r\n                    </p>\r\n                    <hr />\r\n                    <p style={{fontSize:11}}>\r\n                        This site is protected by reCAPTCHA and the Google <a\r\n                        href=\"https://policies.google.com/privacy\">Privacy Policy</a> and <a\r\n                        href=\"https://policies.google.com/terms\">Terms of Service</a> apply.\r\n                    </p>\r\n                    <p>\r\n                        <button onClick={this.props.on_close}>\r\n                            取消\r\n                        </button>\r\n                    </p>\r\n                </div>\r\n            </div>\r\n            </GoogleReCaptchaProvider>,\r\n            this.popup_anchor,\r\n        );\r\n    }\r\n}\r\n\r\nexport class LoginPopup extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state={\r\n            popup_show: false,\r\n        };\r\n        this.on_popup_bound=this.on_popup.bind(this);\r\n        this.on_close_bound=this.on_close.bind(this);\r\n    }\r\n\r\n    on_popup() {\r\n        this.setState({\r\n            popup_show: true,\r\n        });\r\n    }\r\n    on_close() {\r\n        this.setState({\r\n            popup_show: false,\r\n        });\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <>\r\n                {this.props.children(this.on_popup_bound)}\r\n                {this.state.popup_show &&\r\n                    <LoginPopupSelf token_callback={this.props.token_callback} on_close={this.on_close_bound} />\r\n                }\r\n            </>\r\n        );\r\n    }\r\n}","const HOLE_CACHE_DB_NAME = 'hole_cache_db';\r\nconst CACHE_DB_VER = 1;\r\nconst MAINTENANCE_STEP = 150;\r\nconst MAINTENANCE_COUNT = 1000;\r\n\r\nconst ENC_KEY = 42;\r\n\r\nclass Cache {\r\n  constructor() {\r\n    this.db = null;\r\n    this.added_items_since_maintenance = 0;\r\n    this.encrypt = this.encrypt.bind(this);\r\n    this.decrypt = this.decrypt.bind(this);\r\n    const open_req = indexedDB.open(HOLE_CACHE_DB_NAME, CACHE_DB_VER);\r\n    open_req.onerror = console.error.bind(console);\r\n    open_req.onupgradeneeded = (event) => {\r\n      console.log('comment cache db upgrade');\r\n      const db = event.target.result;\r\n      const store = db.createObjectStore('comment', {\r\n        keyPath: 'pid',\r\n      });\r\n      store.createIndex('last_access', 'last_access', { unique: false });\r\n    };\r\n    open_req.onsuccess = (event) => {\r\n      console.log('comment cache db loaded');\r\n      this.db = event.target.result;\r\n      setTimeout(this.maintenance.bind(this), 1);\r\n    };\r\n  }\r\n\r\n  // use window.hole_cache.encrypt() only after cache is loaded!\r\n  encrypt(pid, data) {\r\n    let s = JSON.stringify(data);\r\n    let o = '';\r\n    for (let i = 0, key = (ENC_KEY ^ pid) % 128; i < s.length; i++) {\r\n      let c = s.charCodeAt(i);\r\n      let new_key = (key ^ (c / 2)) % 128;\r\n      o += String.fromCharCode(key ^ s.charCodeAt(i));\r\n      key = new_key;\r\n    }\r\n    return o;\r\n  }\r\n\r\n  // use window.hole_cache.decrypt() only after cache is loaded!\r\n  decrypt(pid, s) {\r\n    let o = '';\r\n    if (typeof s !== typeof 'str') return null;\r\n\r\n    for (let i = 0, key = (ENC_KEY ^ pid) % 128; i < s.length; i++) {\r\n      let c = key ^ s.charCodeAt(i);\r\n      o += String.fromCharCode(c);\r\n      key = (key ^ (c / 2)) % 128;\r\n    }\r\n\r\n    try {\r\n      return JSON.parse(o);\r\n    } catch (e) {\r\n      console.error('decrypt failed');\r\n      console.trace(e);\r\n      return null;\r\n    }\r\n  }\r\n\r\n  get(pid, target_version) {\r\n    pid = parseInt(pid);\r\n    return new Promise((resolve, reject) => {\r\n      if (!this.db) return resolve(null);\r\n      let get_req,store;\r\n      try {\r\n        const tx=this.db.transaction(['comment'],'readwrite');\r\n        store=tx.objectStore('comment');\r\n        get_req=store.get(pid);\r\n      } catch(e) { // ios sometimes fail at here, just ignore it\r\n        console.exception(e);\r\n        resolve(null);\r\n      }\r\n      get_req.onsuccess = () => {\r\n        let res = get_req.result;\r\n        if (!res || !res.data_str) {\r\n          //console.log('comment cache miss '+pid);\r\n          resolve(null);\r\n        } else if (target_version === res.version) {\r\n          // hit\r\n          console.log('comment cache hit', pid);\r\n          res.last_access = +new Date();\r\n          store.put(res);\r\n          let data = this.decrypt(pid, res.data_str);\r\n          resolve(data); // obj or null\r\n        } else {\r\n          // expired\r\n          console.log(\r\n            'comment cache expired',\r\n            pid,\r\n            ': ver',\r\n            res.version,\r\n            'target',\r\n            target_version,\r\n          );\r\n          store.delete(pid);\r\n          resolve(null);\r\n        }\r\n      };\r\n      get_req.onerror = (e) => {\r\n        console.warn('comment cache indexeddb open failed');\r\n        console.error(e);\r\n        resolve(null);\r\n      };\r\n    });\r\n  }\r\n\r\n  put(pid, target_version, data) {\r\n    pid = parseInt(pid);\r\n    return new Promise((resolve, reject) => {\r\n      if (!this.db) return resolve();\r\n      try {\r\n        const tx=this.db.transaction(['comment'],'readwrite');\r\n        const store=tx.objectStore('comment');\r\n        store.put({\r\n            pid: pid,\r\n            version: target_version,\r\n            data_str: this.encrypt(pid,data),\r\n            last_access: +new Date(),\r\n        });\r\n        if(++this.added_items_since_maintenance===MAINTENANCE_STEP)\r\n            setTimeout(this.maintenance.bind(this),1);\r\n      } catch(e) {\r\n        console.exception(e);\r\n        return resolve();\r\n      }\r\n    });\r\n  }\r\n\r\n  delete(pid) {\r\n    pid = parseInt(pid);\r\n    return new Promise((resolve, reject) => {\r\n      if (!this.db) return resolve();\r\n      let req;\r\n      try {\r\n        const tx=this.db.transaction(['comment'],'readwrite');\r\n        const store=tx.objectStore('comment');\r\n        req=store.delete(pid);\r\n      } catch(e) {\r\n        console.exception(e);\r\n        return resolve();\r\n      }\r\n      console.log('comment cache delete', pid);\r\n      req.onerror = () => {\r\n        console.warn('comment cache delete failed ', pid);\r\n        return resolve();\r\n      };\r\n      req.onsuccess = () => resolve();\r\n    });\r\n  }\r\n\r\n  maintenance() {\r\n    if (!this.db) return;\r\n    const tx = this.db.transaction(['comment'], 'readwrite');\r\n    const store = tx.objectStore('comment');\r\n    let count_req = store.count();\r\n    count_req.onsuccess = () => {\r\n      let count = count_req.result;\r\n      if (count > MAINTENANCE_COUNT) {\r\n        console.log('comment cache db maintenance', count);\r\n        store.index('last_access').openKeyCursor().onsuccess = (e) => {\r\n          let cur = e.target.result;\r\n          if (cur) {\r\n            //console.log('maintenance: delete',cur);\r\n            store.delete(cur.primaryKey);\r\n            if (--count > MAINTENANCE_COUNT) cur.continue();\r\n          }\r\n        };\r\n      } else {\r\n        console.log('comment cache db no need to maintenance', count);\r\n      }\r\n      this.added_items_since_maintenance = 0;\r\n    };\r\n    count_req.onerror = console.error.bind(console);\r\n  }\r\n\r\n  clear() {\r\n    if (!this.db) return;\r\n    try {\r\n      indexedDB.deleteDatabase(HOLE_CACHE_DB_NAME);\r\n      console.log('delete comment cache db');\r\n    } catch(e) {\r\n      console.exception(e);\r\n    }\r\n  }\r\n}\r\n\r\nexport function cache() {\r\n  if (!window.hole_cache) window.hole_cache = new Cache();\r\n  return window.hole_cache;\r\n}\r\n","import { get_json, API_VERSION_PARAM } from './infrastructure/functions';\r\nimport { THUHOLE_API_ROOT } from './infrastructure/const';\r\nimport { API_BASE } from './Common';\r\nimport { cache } from './cache';\r\n\r\nexport { THUHOLE_API_ROOT, API_VERSION_PARAM };\r\n\r\nexport function token_param(token) {\r\n  return API_VERSION_PARAM() + (token ? '&user_token=' + token : '');\r\n}\r\n\r\nexport { get_json };\r\n\r\nconst SEARCH_PAGESIZE = 50;\r\n\r\nconst handle_response = async (response, notify = false) => {\r\n  let json = await get_json(response);\r\n  if (json.code !== 0) {\r\n    if (json.msg) {\r\n      if (notify) alert(json.msg);\r\n      else throw new Error(json.msg);\r\n    } else throw new Error(JSON.stringify(json));\r\n  }\r\n  return json;\r\n};\r\n\r\nconst parse_replies = (replies, color_picker) =>\r\n  replies\r\n    .sort((a, b) => parseInt(a.cid, 10) - parseInt(b.cid, 10))\r\n    .map((info) => {\r\n      info._display_color = color_picker.get(info.name);\r\n      info.variant = {};\r\n      return info;\r\n    });\r\n\r\nexport const API = {\r\n  load_replies: async (pid, token, color_picker, cache_version) => {\r\n    pid = parseInt(pid);\r\n    let response = await fetch(\r\n      API_BASE + '/api.php?action=getcomment&pid=' + pid + token_param(token),\r\n    );\r\n    let json = await handle_response(response);\r\n    // Why delete then put ??\r\n    cache().put(pid, cache_version, json);\r\n    json.data = parse_replies(json.data, color_picker);\r\n    return json;\r\n  },\r\n\r\n  load_replies_with_cache: async (pid, token, color_picker, cache_version) => {\r\n    pid = parseInt(pid);\r\n    let json = await cache().get(pid, cache_version);\r\n    if (json) {\r\n      json.data = parse_replies(json.data, color_picker);\r\n      return { data: json, cached: true };\r\n    } else {\r\n      json = await API.load_replies(pid, token, color_picker, cache_version);\r\n      return { data: json, cached: !json };\r\n    }\r\n  },\r\n\r\n  set_attention: async (pid, attention, token) => {\r\n    let data = new URLSearchParams();\r\n    data.append('user_token', token);\r\n    data.append('pid', pid);\r\n    data.append('switch', attention ? '1' : '0');\r\n    let response = await fetch(\r\n      API_BASE + '/api.php?action=attention' + token_param(token),\r\n      {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/x-www-form-urlencoded',\r\n        },\r\n        body: data,\r\n      },\r\n    );\r\n    // Delete cache to update `attention` on next reload\r\n    cache().delete(pid);\r\n    return handle_response(response, true);\r\n  },\r\n\r\n  report: async (pid, reason, token) => {\r\n    let data = new URLSearchParams();\r\n    data.append('user_token', token);\r\n    data.append('pid', pid);\r\n    data.append('reason', reason);\r\n    let response = await fetch(\r\n      API_BASE + '/api.php?action=report' + token_param(token),\r\n      {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/x-www-form-urlencoded',\r\n        },\r\n        body: data,\r\n      },\r\n    );\r\n    return handle_response(response, true);\r\n  },\r\n\r\n  get_list: async (page, token) => {\r\n    let response = await fetch(\r\n      API_BASE + '/api.php?action=getlist' + '&p=' + page + token_param(token),\r\n    );\r\n    return handle_response(response);\r\n  },\r\n\r\n  get_search: async (page, keyword, token) => {\r\n    let response = await fetch(\r\n      API_BASE +\r\n        '/api.php?action=search' +\r\n        '&pagesize=' +\r\n        SEARCH_PAGESIZE +\r\n        '&page=' +\r\n        page +\r\n        '&keywords=' +\r\n        encodeURIComponent(keyword) +\r\n        token_param(token),\r\n    );\r\n    return handle_response(response);\r\n  },\r\n\r\n  get_single: async (pid, token) => {\r\n    let response = await fetch(\r\n      API_BASE + '/api.php?action=getone' + '&pid=' + pid + token_param(token),\r\n    );\r\n    return handle_response(response);\r\n  },\r\n\r\n  get_attention: async (token) => {\r\n    let response = await fetch(\r\n      API_BASE + '/api.php?action=getattention' + token_param(token),\r\n    );\r\n    return handle_response(response);\r\n  },\r\n};\r\n","import MarkdownIt from 'markdown-it';\r\nimport MarkdownItKaTeX from 'markdown-it-katex';\r\nimport hljs from 'highlight.js';\r\nimport 'highlight.js/styles/atom-one-dark.css';\r\nimport './Markdown.css';\r\n\r\nimport 'katex/dist/katex.min.css';\r\n\r\nlet md = new MarkdownIt({\r\n  html: false,\r\n  linkify: false,\r\n  breaks: true,\r\n  inline: true,\r\n  highlight(str, lang) {\r\n    if (lang && hljs.getLanguage(lang)) {\r\n      try {\r\n        return (\r\n          '<pre class=\"hljs\"><code>' +\r\n          hljs.highlight(lang, str, true).value +\r\n          '</code></pre>'\r\n        );\r\n      } catch (__) {}\r\n    }\r\n    return (\r\n      '<pre class=\"hljs\"><code>' + md.utils.escapeHtml(str) + '</code></pre>'\r\n    );\r\n  },\r\n}).use(MarkdownItKaTeX, {\r\n  throwOnError: false,\r\n  errorColor: '#aa0000',\r\n});\r\n\r\nexport default (text) => md.render(text);\r\n","import React, { Component, PureComponent } from 'react';\r\nimport { format_time, Time, TitleLine } from './infrastructure/widgets';\r\nimport { THUHOLE_API_ROOT } from './flows_api';\r\n\r\nimport HtmlToReact from 'html-to-react';\r\n\r\nimport './Common.css';\r\nimport {\r\n  URL_PID_RE,\r\n  URL_RE,\r\n  PID_RE,\r\n  NICKNAME_RE,\r\n  split_text,\r\n} from './text_splitter';\r\n\r\nimport renderMd from './Markdown';\r\n\r\nexport { format_time, Time, TitleLine };\r\n\r\nexport const API_BASE = THUHOLE_API_ROOT + 'services/thuhole';\r\n\r\n// https://stackoverflow.com/questions/3446170/escape-string-for-use-in-javascript-regex\r\nfunction escape_regex(string) {\r\n  return string.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'); // $& means the whole matched string\r\n}\r\n\r\nexport function build_highlight_re(\r\n  txt,\r\n  split = ' ',\r\n  option = 'g',\r\n  isRegex = false,\r\n) {\r\n  if (isRegex) {\r\n    try {\r\n      return new RegExp('(' + txt.slice(1, -1) + ')', option);\r\n    } catch (e) {\r\n      return /^$/g;\r\n    }\r\n  } else {\r\n    return txt\r\n      ? new RegExp(\r\n          `(${txt\r\n            .split(split)\r\n            .filter((x) => !!x)\r\n            .map(escape_regex)\r\n            .join('|')})`,\r\n          option,\r\n        )\r\n      : /^$/g;\r\n  }\r\n}\r\n\r\nexport function ColoredSpan(props) {\r\n  return (\r\n    <span\r\n      className=\"colored-span\"\r\n      style={{\r\n        '--coloredspan-bgcolor-light': props.colors[0],\r\n        '--coloredspan-bgcolor-dark': props.colors[1],\r\n      }}\r\n    >\r\n      {props.children}\r\n    </span>\r\n  );\r\n}\r\n\r\nfunction normalize_url(url) {\r\n  return /^https?:\\/\\//.test(url) ? url : 'http://' + url;\r\n}\r\n\r\nexport class HighlightedText extends PureComponent {\r\n  render() {\r\n    return (\r\n      <pre>\r\n        {this.props.parts.map((part, idx) => {\r\n          let [rule, p] = part;\r\n          return (\r\n            <span key={idx}>\r\n              {rule === 'url_pid' ? (\r\n                <span className=\"url-pid-link\" title={p}>\r\n                  /##\r\n                </span>\r\n              ) : rule === 'url' ? (\r\n                <a href={normalize_url(p)} target=\"_blank\" rel=\"noopener\">\r\n                  {p}\r\n                </a>\r\n              ) : rule === 'pid' ? (\r\n                <a\r\n                  href={'#' + p}\r\n                  onClick={(e) => {\r\n                    e.preventDefault();\r\n                    this.props.show_pid(p.substring(1));\r\n                  }}\r\n                >\r\n                  {p}\r\n                </a>\r\n              ) : rule === 'nickname' ? (\r\n                <ColoredSpan colors={this.props.color_picker.get(p)}>\r\n                  {p}\r\n                </ColoredSpan>\r\n              ) : rule === 'search' ? (\r\n                <span className=\"search-query-highlight\">{p}</span>\r\n              ) : (\r\n                p\r\n              )}\r\n            </span>\r\n          );\r\n        })}\r\n      </pre>\r\n    );\r\n  }\r\n}\r\n\r\n// props: text, show_pid, color_picker\r\nexport class HighlightedMarkdown extends Component {\r\n  render() {\r\n    const props = this.props;\r\n    const processDefs = new HtmlToReact.ProcessNodeDefinitions(React);\r\n    const processInstructions = [\r\n      {\r\n        shouldProcessNode: (node) => node.name === 'img', // disable images\r\n        processNode(node, children, index) {\r\n          return <div key={index}>[图片]</div>;\r\n        },\r\n      },\r\n      {\r\n        shouldProcessNode: (node) => /^h[123456]$/.test(node.name),\r\n        processNode(node, children, index) {\r\n          let currentLevel = +node.name[1];\r\n          if (currentLevel < 3) currentLevel = 3;\r\n          const HeadingTag = `h${currentLevel}`;\r\n          return <HeadingTag key={index}>{children}</HeadingTag>;\r\n        },\r\n      },\r\n      {\r\n        shouldProcessNode: (node) => node.name === 'a',\r\n        processNode(node, children, index) {\r\n          return (\r\n            <a\r\n              href={normalize_url(node.attribs.href)}\r\n              target=\"_blank\"\r\n              rel=\"noopenner noreferrer\"\r\n              className=\"ext-link\"\r\n              key={index}\r\n            >\r\n              {children}\r\n              <span className=\"icon icon-new-tab\" />\r\n            </a>\r\n          );\r\n        },\r\n      },\r\n      {\r\n        shouldProcessNode(node) {\r\n          return (\r\n            node.type === 'text' &&\r\n            (!node.parent ||\r\n              !node.parent.attribs ||\r\n              node.parent.attribs['encoding'] !== 'application/x-tex')\r\n          ); // pid, nickname, search\r\n        },\r\n        processNode(node, children, index) {\r\n          const originalText = node.data;\r\n          const splitted = split_text(originalText, [\r\n            ['url_pid', URL_PID_RE],\r\n            ['url', URL_RE],\r\n            ['pid', PID_RE],\r\n            ['nickname', NICKNAME_RE],\r\n          ]);\r\n\r\n          return (\r\n            <React.Fragment key={index}>\r\n              {splitted.map(([rule, p], idx) => {\r\n                return (\r\n                  <span key={idx}>\r\n                    {rule === 'url_pid' ? (\r\n                      <span className=\"url-pid-link\" title={p}>\r\n                        /##\r\n                      </span>\r\n                    ) : rule === 'url' ? (\r\n                      <a\r\n                        href={normalize_url(p)}\r\n                        className=\"ext-link\"\r\n                        target=\"_blank\"\r\n                        rel=\"noopener noreferrer\"\r\n                      >\r\n                        {p}\r\n                        <span className=\"icon icon-new-tab\" />\r\n                      </a>\r\n                    ) : rule === 'pid' ? (\r\n                      <a\r\n                        href={'#' + p}\r\n                        onClick={(e) => {\r\n                          e.preventDefault();\r\n                          props.show_pid(p.substring(1));\r\n                        }}\r\n                      >\r\n                        {p}\r\n                      </a>\r\n                    ) : rule === 'nickname' ? (\r\n                      <ColoredSpan colors={props.color_picker.get(p)}>\r\n                        {p}\r\n                      </ColoredSpan>\r\n                    ) : rule === 'search' ? (\r\n                      <span className=\"search-query-highlight\">{p}</span>\r\n                    ) : (\r\n                      p\r\n                    )}\r\n                  </span>\r\n                );\r\n              })}\r\n            </React.Fragment>\r\n          );\r\n        },\r\n      },\r\n      {\r\n        shouldProcessNode: () => true,\r\n        processNode: processDefs.processDefaultNode,\r\n      },\r\n    ];\r\n    const parser = new HtmlToReact.Parser();\r\n    if (props.author && props.text.match(/^(?:#+ |>|```|\\t|\\s*-|\\s*\\d+\\.)/)) {\r\n      const renderedMarkdown = renderMd(props.text);\r\n      return (\r\n        <>\r\n          {props.author}\r\n          {parser.parseWithInstructions(\r\n            renderedMarkdown,\r\n            (node) => node.type !== 'script',\r\n            processInstructions,\r\n          ) || ''}\r\n        </>\r\n      );\r\n    } else {\r\n      let rawMd = props.text;\r\n      if (props.author) rawMd = props.author + ' ' + rawMd;\r\n      const renderedMarkdown = renderMd(rawMd);\r\n      return (\r\n        parser.parseWithInstructions(\r\n          renderedMarkdown,\r\n          (node) => node.type !== 'script',\r\n          processInstructions,\r\n        ) || null\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nwindow.TEXTAREA_BACKUP = {};\r\n\r\nexport class SafeTextarea extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      text: '',\r\n    };\r\n    this.on_change_bound = this.on_change.bind(this);\r\n    this.on_keydown_bound = this.on_keydown.bind(this);\r\n    this.clear = this.clear.bind(this);\r\n    this.area_ref = React.createRef();\r\n    this.change_callback = props.on_change || (() => {});\r\n    this.submit_callback = props.on_submit || (() => {});\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.setState(\r\n      {\r\n        text: window.TEXTAREA_BACKUP[this.props.id] || '',\r\n      },\r\n      () => {\r\n        this.change_callback(this.state.text);\r\n      },\r\n    );\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    window.TEXTAREA_BACKUP[this.props.id] = this.state.text;\r\n    this.change_callback(this.state.text);\r\n  }\r\n\r\n  on_change(event) {\r\n    this.setState({\r\n      text: event.target.value,\r\n    });\r\n    this.change_callback(event.target.value);\r\n  }\r\n  on_keydown(event) {\r\n    if (event.key === 'Enter' && event.ctrlKey && !event.altKey) {\r\n      event.preventDefault();\r\n      this.submit_callback();\r\n    }\r\n  }\r\n\r\n  clear() {\r\n    this.setState({\r\n      text: '',\r\n    });\r\n  }\r\n  set(text) {\r\n    this.change_callback(text);\r\n    this.setState({\r\n      text: text,\r\n    });\r\n  }\r\n  get() {\r\n    return this.state.text;\r\n  }\r\n  focus() {\r\n    this.area_ref.current.focus();\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <textarea\r\n        ref={this.area_ref}\r\n        onChange={this.on_change_bound}\r\n        value={this.state.text}\r\n        onKeyDown={this.on_keydown_bound}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nlet pwa_prompt_event = null;\r\nwindow.addEventListener('beforeinstallprompt', (e) => {\r\n  console.log('pwa: received before install prompt');\r\n  pwa_prompt_event = e;\r\n});\r\n\r\nexport function PromotionBar(props) {\r\n  let is_ios = /iPhone|iPad|iPod/i.test(window.navigator.userAgent);\r\n  let is_installed =\r\n    window.matchMedia('(display-mode: standalone)').matches ||\r\n    window.navigator.standalone;\r\n\r\n  if (is_installed) return null;\r\n\r\n  if (is_ios)\r\n    // noinspection JSConstructorReturnsPrimitive\r\n    return !navigator.standalone ? (\r\n      <div className=\"box promotion-bar\">\r\n        <span className=\"icon icon-about\" />\r\n        &nbsp; 用 Safari 把树洞 <b>添加到主屏幕</b> 更好用\r\n      </div>\r\n    ) : null;\r\n  // noinspection JSConstructorReturnsPrimitive\r\n  else\r\n    return pwa_prompt_event ? (\r\n      <div className=\"box promotion-bar\">\r\n        <span className=\"icon icon-about\" />\r\n        &nbsp; 把网页版树洞{' '}\r\n        <b>\r\n          <a\r\n            onClick={() => {\r\n              if (pwa_prompt_event) pwa_prompt_event.prompt();\r\n            }}\r\n          >\r\n            安装到桌面\r\n          </a>\r\n        </b>{' '}\r\n        更好用\r\n      </div>\r\n    ) : null;\r\n}\r\n\r\nexport class ClickHandler extends PureComponent {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      moved: true,\r\n      init_y: 0,\r\n      init_x: 0,\r\n    };\r\n    this.on_begin_bound = this.on_begin.bind(this);\r\n    this.on_move_bound = this.on_move.bind(this);\r\n    this.on_end_bound = this.on_end.bind(this);\r\n\r\n    this.MOVE_THRESHOLD = 3;\r\n    this.last_fire = 0;\r\n  }\r\n\r\n  on_begin(e) {\r\n    //console.log('click',(e.touches?e.touches[0]:e).screenY,(e.touches?e.touches[0]:e).screenX);\r\n    this.setState({\r\n      moved: false,\r\n      init_y: (e.touches ? e.touches[0] : e).screenY,\r\n      init_x: (e.touches ? e.touches[0] : e).screenX,\r\n    });\r\n  }\r\n  on_move(e) {\r\n    if (!this.state.moved) {\r\n      let mvmt =\r\n        Math.abs((e.touches ? e.touches[0] : e).screenY - this.state.init_y) +\r\n        Math.abs((e.touches ? e.touches[0] : e).screenX - this.state.init_x);\r\n      //console.log('move',mvmt);\r\n      if (mvmt > this.MOVE_THRESHOLD)\r\n        this.setState({\r\n          moved: true,\r\n        });\r\n    }\r\n  }\r\n  on_end(event) {\r\n    //console.log('end');\r\n    if (!this.state.moved) this.do_callback(event);\r\n    this.setState({\r\n      moved: true,\r\n    });\r\n  }\r\n\r\n  do_callback(event) {\r\n    if (this.last_fire + 100 > +new Date()) return;\r\n    this.last_fire = +new Date();\r\n    this.props.callback(event);\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div\r\n        onTouchStart={this.on_begin_bound}\r\n        onMouseDown={this.on_begin_bound}\r\n        onTouchMove={this.on_move_bound}\r\n        onMouseMove={this.on_move_bound}\r\n        onClick={this.on_end_bound}\r\n      >\r\n        {this.props.children}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","export function on(el, eventName, callback, opts) {\r\n  opts = opts || false;\r\n  if (el.addEventListener) {\r\n    el.addEventListener(eventName, callback, opts);\r\n  } else if (el.attachEvent) {\r\n    el.attachEvent(`on${eventName}`, (e) => {\r\n      callback.call(el, e || window.event);\r\n    });\r\n  }\r\n}\r\n\r\nexport function off(el, eventName, callback, opts) {\r\n  opts = opts || false;\r\n  if (el.removeEventListener) {\r\n    el.removeEventListener(eventName, callback, opts);\r\n  } else if (el.detachEvent) {\r\n    el.detachEvent(`on${eventName}`, callback);\r\n  }\r\n}\r\n","/**\r\n * @fileOverview Find scroll parent\r\n */\r\n\r\nexport default (node) => {\r\n  if (!(node instanceof HTMLElement)) {\r\n    return document.documentElement;\r\n  }\r\n\r\n  const excludeStaticParent = node.style.position === 'absolute';\r\n  const overflowRegex = /(scroll|auto)/;\r\n  let parent = node;\r\n\r\n  while (parent) {\r\n    if (!parent.parentNode) {\r\n      return node.ownerDocument || document.documentElement;\r\n    }\r\n\r\n    const style = window.getComputedStyle(parent);\r\n    const position = style.position;\r\n    const overflow = style.overflow;\r\n    const overflowX = style['overflow-x'];\r\n    const overflowY = style['overflow-y'];\r\n\r\n    if (position === 'static' && excludeStaticParent) {\r\n      parent = parent.parentNode;\r\n      continue;\r\n    }\r\n\r\n    if (overflowRegex.test(overflow) && overflowRegex.test(overflowX) && overflowRegex.test(overflowY)) {\r\n      return parent;\r\n    }\r\n\r\n    parent = parent.parentNode;\r\n  }\r\n\r\n  return node.ownerDocument || node.documentElement || document.documentElement;\r\n};\r\n","/**\r\n * react-lazyload\r\n */\r\nimport React, { Component, PureComponent } from 'react';\r\nimport ReactDom from 'react-dom';\r\nimport PropTypes from 'prop-types';\r\nimport { on, off } from './utils/event';\r\nimport scrollParent from './utils/scrollParent';\r\nimport debounce from './utils/debounce';\r\nimport throttle from './utils/throttle';\r\n\r\nconst defaultBoundingClientRect = { top: 0, right: 0, bottom: 0, left: 0, width: 0, height: 0 };\r\nconst LISTEN_FLAG = 'data-lazyload-listened';\r\nconst listeners = [];\r\nlet pending = [];\r\n\r\n// try to handle passive events\r\nlet passiveEventSupported = false;\r\ntry {\r\n  const opts = Object.defineProperty({}, 'passive', {\r\n    get() {\r\n      passiveEventSupported = true;\r\n    }\r\n  });\r\n  window.addEventListener('test', null, opts);\r\n}\r\ncatch (e) { }\r\n// if they are supported, setup the optional params\r\n// IMPORTANT: FALSE doubles as the default CAPTURE value!\r\nconst passiveEvent = passiveEventSupported ? { capture: false, passive: true } : false;\r\n\r\n\r\n/**\r\n * Check if `component` is visible in overflow container `parent`\r\n * @param  {node} component React component\r\n * @param  {node} parent    component's scroll parent\r\n * @return {bool}\r\n */\r\nconst checkOverflowVisible = function checkOverflowVisible(component, parent) {\r\n  const node = ReactDom.findDOMNode(component);\r\n\r\n  let parentTop;\r\n  let parentHeight;\r\n\r\n  try {\r\n    ({ top: parentTop, height: parentHeight } = parent.getBoundingClientRect());\r\n  } catch (e) {\r\n    ({ top: parentTop, height: parentHeight } = defaultBoundingClientRect);\r\n  }\r\n\r\n  const windowInnerHeight = window.innerHeight || document.documentElement.clientHeight;\r\n\r\n  // calculate top and height of the intersection of the element's scrollParent and viewport\r\n  const intersectionTop = Math.max(parentTop, 0); // intersection's top relative to viewport\r\n  const intersectionHeight = Math.min(windowInnerHeight, parentTop + parentHeight) - intersectionTop; // height\r\n\r\n  // check whether the element is visible in the intersection\r\n  let top;\r\n  let height;\r\n\r\n  try {\r\n    ({ top, height } = node.getBoundingClientRect());\r\n  } catch (e) {\r\n    ({ top, height } = defaultBoundingClientRect);\r\n  }\r\n\r\n  const offsetTop = top - intersectionTop; // element's top relative to intersection\r\n\r\n  const offsets = Array.isArray(component.props.offset) ?\r\n                component.props.offset :\r\n                [component.props.offset, component.props.offset]; // Be compatible with previous API\r\n\r\n  return (offsetTop - offsets[0] <= intersectionHeight) &&\r\n         (offsetTop + height + offsets[1] >= 0);\r\n};\r\n\r\n/**\r\n * Check if `component` is visible in document\r\n * @param  {node} component React component\r\n * @return {bool}\r\n */\r\nconst checkNormalVisible = function checkNormalVisible(component) {\r\n  const node = ReactDom.findDOMNode(component);\r\n\r\n  // If this element is hidden by css rules somehow, it's definitely invisible\r\n  if (!(node.offsetWidth || node.offsetHeight || node.getClientRects().length)) return false;\r\n\r\n  let top;\r\n  let elementHeight;\r\n\r\n  try {\r\n    ({ top, height: elementHeight } = node.getBoundingClientRect());\r\n  } catch (e) {\r\n    ({ top, height: elementHeight } = defaultBoundingClientRect);\r\n  }\r\n\r\n  const windowInnerHeight = window.innerHeight || document.documentElement.clientHeight;\r\n\r\n  const offsets = Array.isArray(component.props.offset) ?\r\n                component.props.offset :\r\n                [component.props.offset, component.props.offset]; // Be compatible with previous API\r\n\r\n  return (top - offsets[0] <= windowInnerHeight) &&\r\n         (top + elementHeight + offsets[1] >= 0);\r\n};\r\n\r\n\r\n/**\r\n * Detect if element is visible in viewport, if so, set `visible` state to true.\r\n * If `once` prop is provided true, remove component as listener after checkVisible\r\n *\r\n * @param  {React} component   React component that respond to scroll and resize\r\n */\r\nconst checkVisible = function checkVisible(component) {\r\n  const node = ReactDom.findDOMNode(component);\r\n  if (!(node instanceof HTMLElement)) {\r\n    return;\r\n  }\r\n\r\n  const parent = scrollParent(node);\r\n  const isOverflow = component.props.overflow &&\r\n                     parent !== node.ownerDocument &&\r\n                     parent !== document &&\r\n                     parent !== document.documentElement;\r\n  const visible = isOverflow ?\r\n                  checkOverflowVisible(component, parent) :\r\n                  checkNormalVisible(component);\r\n  if (visible) {\r\n    // Avoid extra render if previously is visible\r\n    if (!component.state.visible || component.state.hidden) {\r\n      if (component.props.once) {\r\n        pending.push(component);\r\n      }\r\n\r\n      //console.log('lazyload 1');\r\n      component.setState({\r\n        visible: true,\r\n        hidden: false,\r\n      });\r\n    }\r\n  } else if (!component.props.once) {\r\n    if (component.props.unmountIfInvisible) {\r\n      if(component.visible===true)\r\n        component.setState({\r\n          visible: false,\r\n        });\r\n    } else if(component.props.hiddenIfInvisible) {\r\n      if(component.state.hidden===false) {\r\n        //console.log('lazyload 3');\r\n        component.setState({\r\n          hidden: true,\r\n        });\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\n\r\nconst purgePending = function purgePending() {\r\n  pending.forEach((component) => {\r\n    const index = listeners.indexOf(component);\r\n    if (index !== -1) {\r\n      listeners.splice(index, 1);\r\n    }\r\n  });\r\n\r\n  pending = [];\r\n};\r\n\r\nconst lazyLoadHandler = () => {\r\n  for (let i = 0; i < listeners.length; ++i) {\r\n    const listener = listeners[i];\r\n    checkVisible(listener);\r\n  }\r\n  // Remove `once` component in listeners\r\n  purgePending();\r\n};\r\n\r\n// Depending on component's props\r\nlet delayType;\r\nlet finalLazyLoadHandler = null;\r\n\r\nconst isString = string => typeof string === 'string';\r\n\r\nclass LazyLoad extends PureComponent {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state={\r\n      visible: false,\r\n      hidden: false,\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    // It's unlikely to change delay type on the fly, this is mainly\r\n    // designed for tests\r\n    let scrollport = window;\r\n    const {\r\n      scrollContainer,\r\n    } = this.props;\r\n    if (scrollContainer) {\r\n      if (isString(scrollContainer)) {\r\n        scrollport = scrollport.document.querySelector(scrollContainer);\r\n      }\r\n    }\r\n    const needResetFinalLazyLoadHandler = (this.props.debounce !== undefined && delayType === 'throttle')\r\n      || (delayType === 'debounce' && this.props.debounce === undefined);\r\n\r\n    if (needResetFinalLazyLoadHandler) {\r\n      off(scrollport, 'scroll', finalLazyLoadHandler, passiveEvent);\r\n      off(window, 'resize', finalLazyLoadHandler, passiveEvent);\r\n      finalLazyLoadHandler = null;\r\n    }\r\n\r\n    if (!finalLazyLoadHandler) {\r\n      if (this.props.debounce !== undefined) {\r\n        finalLazyLoadHandler = debounce(lazyLoadHandler, typeof this.props.debounce === 'number' ?\r\n                                                         this.props.debounce :\r\n                                                         300);\r\n        delayType = 'debounce';\r\n      } else if (this.props.throttle !== undefined) {\r\n        finalLazyLoadHandler = throttle(lazyLoadHandler, typeof this.props.throttle === 'number' ?\r\n                                                         this.props.throttle :\r\n                                                         300);\r\n        delayType = 'throttle';\r\n      } else {\r\n        finalLazyLoadHandler = lazyLoadHandler;\r\n      }\r\n    }\r\n\r\n    if (this.props.overflow) {\r\n      const parent = scrollParent(ReactDom.findDOMNode(this));\r\n      if (parent && typeof parent.getAttribute === 'function') {\r\n        const listenerCount = 1 + (+parent.getAttribute(LISTEN_FLAG));\r\n        if (listenerCount === 1) {\r\n          parent.addEventListener('scroll', finalLazyLoadHandler, passiveEvent);\r\n        }\r\n        parent.setAttribute(LISTEN_FLAG, listenerCount);\r\n      }\r\n    } else if (listeners.length === 0 || needResetFinalLazyLoadHandler) {\r\n      const { scroll, resize } = this.props;\r\n\r\n      if (scroll) {\r\n        on(scrollport, 'scroll', finalLazyLoadHandler, passiveEvent);\r\n      }\r\n\r\n      if (resize) {\r\n        on(window, 'resize', finalLazyLoadHandler, passiveEvent);\r\n      }\r\n    }\r\n\r\n    listeners.push(this);\r\n    checkVisible(this);\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    if (this.props.overflow) {\r\n      const parent = scrollParent(ReactDom.findDOMNode(this));\r\n      if (parent && typeof parent.getAttribute === 'function') {\r\n        const listenerCount = (+parent.getAttribute(LISTEN_FLAG)) - 1;\r\n        if (listenerCount === 0) {\r\n          parent.removeEventListener('scroll', finalLazyLoadHandler, passiveEvent);\r\n          parent.removeAttribute(LISTEN_FLAG);\r\n        } else {\r\n          parent.setAttribute(LISTEN_FLAG, listenerCount);\r\n        }\r\n      }\r\n    }\r\n\r\n    const index = listeners.indexOf(this);\r\n    if (index !== -1) {\r\n      listeners.splice(index, 1);\r\n    }\r\n\r\n    if (listeners.length === 0 && typeof window !== 'undefined') {\r\n      off(window, 'resize', finalLazyLoadHandler, passiveEvent);\r\n      off(window, 'scroll', finalLazyLoadHandler, passiveEvent);\r\n    }\r\n  }\r\n\r\n  render() {\r\n    //console.log('lazyload render');\r\n    if(this.state.visible) {\r\n      if(this.props.hiddenIfInvisible)\r\n        return this.state.hidden ?\r\n            <div style={{visibility: 'hidden'}}>{this.props.children}</div> :\r\n            <div>{this.props.children}</div>;\r\n      else\r\n        return this.props.children;\r\n    }\r\n    else\r\n      return this.props.placeholder ?\r\n                this.props.placeholder :\r\n                <div style={{ height: this.props.height }} className=\"lazyload-placeholder\" />;\r\n  }\r\n}\r\n\r\nLazyLoad.propTypes = {\r\n  once: PropTypes.bool,\r\n  height: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\r\n  offset: PropTypes.oneOfType([PropTypes.number, PropTypes.arrayOf(PropTypes.number)]),\r\n  overflow: PropTypes.bool,\r\n  resize: PropTypes.bool,\r\n  scroll: PropTypes.bool,\r\n  children: PropTypes.node,\r\n  throttle: PropTypes.oneOfType([PropTypes.number, PropTypes.bool]),\r\n  debounce: PropTypes.oneOfType([PropTypes.number, PropTypes.bool]),\r\n  placeholder: PropTypes.node,\r\n  scrollContainer: PropTypes.oneOfType([PropTypes.string, PropTypes.object]),\r\n  unmountIfInvisible: PropTypes.bool,\r\n  hiddenIfInvisible: PropTypes.bool,\r\n};\r\n\r\nLazyLoad.defaultProps = {\r\n  once: false,\r\n  offset: 0,\r\n  overflow: false,\r\n  resize: false,\r\n  scroll: true,\r\n  unmountIfInvisible: false,\r\n  hiddenIfInvisible: false,\r\n};\r\n\r\nconst getDisplayName = WrappedComponent => WrappedComponent.displayName || WrappedComponent.name || 'Component';\r\n\r\nconst decorator = (options = {}) => function lazyload(WrappedComponent) {\r\n  return class LazyLoadDecorated extends Component {\r\n    constructor() {\r\n      super();\r\n      this.displayName = `LazyLoad${getDisplayName(WrappedComponent)}`;\r\n    }\r\n\r\n    render() {\r\n      return (\r\n        <LazyLoad {...options}>\r\n          <WrappedComponent {...this.props} />\r\n        </LazyLoad>\r\n      );\r\n    }\r\n  };\r\n};\r\n\r\nexport { decorator as lazyload };\r\nexport default LazyLoad;\r\nexport { lazyLoadHandler as forceCheck };\r\n","export default function debounce(func, wait, immediate) {\r\n  let timeout;\r\n  let args;\r\n  let context;\r\n  let timestamp;\r\n  let result;\r\n\r\n  const later = function later() {\r\n    const last = +(new Date()) - timestamp;\r\n\r\n    if (last < wait && last >= 0) {\r\n      timeout = setTimeout(later, wait - last);\r\n    } else {\r\n      timeout = null;\r\n      if (!immediate) {\r\n        result = func.apply(context, args);\r\n        if (!timeout) {\r\n          context = null;\r\n          args = null;\r\n        }\r\n      }\r\n    }\r\n  };\r\n\r\n  return function debounced() {\r\n    context = this;\r\n    args = arguments;\r\n    timestamp = +(new Date());\r\n\r\n    const callNow = immediate && !timeout;\r\n    if (!timeout) {\r\n      timeout = setTimeout(later, wait);\r\n    }\r\n\r\n    if (callNow) {\r\n      result = func.apply(context, args);\r\n      context = null;\r\n      args = null;\r\n    }\r\n\r\n    return result;\r\n  };\r\n}\r\n","/*eslint-disable */\r\nexport default function throttle(fn, threshhold, scope) {\r\n  threshhold || (threshhold = 250);\r\n  var last,\r\n      deferTimer;\r\n  return function () {\r\n    var context = scope || this;\r\n\r\n    var now = +new Date,\r\n        args = arguments;\r\n    if (last && now < last + threshhold) {\r\n      // hold on to it\r\n      clearTimeout(deferTimer);\r\n      deferTimer = setTimeout(function () {\r\n        last = now;\r\n        fn.apply(context, args);\r\n      }, threshhold);\r\n    } else {\r\n      last = now;\r\n      fn.apply(context, args);\r\n    }\r\n  };\r\n}\r\n","import React, { Component } from 'react';\r\nimport load from 'load-script';\r\n\r\nwindow.audio_cache = {};\r\n\r\nfunction load_amrnb() {\r\n  return new Promise((resolve, reject) => {\r\n    if (window.AMR) resolve();\r\n    else\r\n      load('static/amr_all.min.js', (err) => {\r\n        if (err) reject(err);\r\n        else resolve();\r\n      });\r\n  });\r\n}\r\n\r\nexport class AudioWidget extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      url: this.props.src,\r\n      state: 'waiting',\r\n      data: null,\r\n    };\r\n  }\r\n\r\n  load() {\r\n    if (window.audio_cache[this.state.url]) {\r\n      this.setState({\r\n        state: 'loaded',\r\n        data: window.audio_cache[this.state.url],\r\n      });\r\n      return;\r\n    }\r\n\r\n    console.log('fetching audio', this.state.url);\r\n    this.setState({\r\n      state: 'loading',\r\n    });\r\n    Promise.all([fetch(this.state.url), load_amrnb()]).then((res) => {\r\n      res[0].blob().then((blob) => {\r\n        const reader = new FileReader();\r\n        reader.onload = (event) => {\r\n          const raw = new window.AMR().decode(event.target.result);\r\n          if (!raw) {\r\n            alert('audio decoding failed');\r\n            return;\r\n          }\r\n          const wave = window.PCMData.encode({\r\n            sampleRate: 8000,\r\n            channelCount: 1,\r\n            bytesPerSample: 2,\r\n            data: raw,\r\n          });\r\n          const binary_wave = new Uint8Array(wave.length);\r\n          for (let i = 0; i < wave.length; i++)\r\n            binary_wave[i] = wave.charCodeAt(i);\r\n\r\n          const objurl = URL.createObjectURL(\r\n            new Blob([binary_wave], { type: 'audio/wav' }),\r\n          );\r\n          window.audio_cache[this.state.url] = objurl;\r\n          this.setState({\r\n            state: 'loaded',\r\n            data: objurl,\r\n          });\r\n        };\r\n        reader.readAsBinaryString(blob);\r\n      });\r\n      this.setState({\r\n        state: 'decoding',\r\n      });\r\n    });\r\n  }\r\n\r\n  render() {\r\n    if (this.state.state === 'waiting')\r\n      return (\r\n        <p>\r\n          <a onClick={this.load.bind(this)}>加载音频</a>\r\n        </p>\r\n      );\r\n    if (this.state.state === 'loading') return <p>正在下载……</p>;\r\n    else if (this.state.state === 'decoding') return <p>正在解码……</p>;\r\n    else if (this.state.state === 'loaded')\r\n      return (\r\n        <p>\r\n          <audio src={this.state.data} controls />\r\n        </p>\r\n      );\r\n  }\r\n}\r\n","import React, { PureComponent } from 'react';\r\nimport { THUHOLE_API_ROOT, get_json, API_VERSION_PARAM } from './flows_api';\r\nimport { Time } from './Common';\r\n\r\nexport class MessageViewer extends PureComponent {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      loading_status: 'idle',\r\n      msg: [],\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.load();\r\n  }\r\n\r\n  load() {\r\n    if (this.state.loading_status === 'loading') return;\r\n    this.setState(\r\n      {\r\n        loading_status: 'loading',\r\n      },\r\n      () => {\r\n        fetch(\r\n          THUHOLE_API_ROOT +\r\n            'api_xmcp/hole/system_msg?user_token=' +\r\n            encodeURIComponent(this.props.token) +\r\n            API_VERSION_PARAM(),\r\n        )\r\n          .then(get_json)\r\n          .then((json) => {\r\n            if (json.error) throw new Error(json.error);\r\n            else\r\n              this.setState({\r\n                loading_status: 'done',\r\n                msg: json.result,\r\n              });\r\n          })\r\n          .catch((err) => {\r\n            console.error(err);\r\n            alert('' + err);\r\n            this.setState({\r\n              loading_status: 'failed',\r\n            });\r\n          });\r\n      },\r\n    );\r\n  }\r\n\r\n  render() {\r\n    if (this.state.loading_status === 'loading')\r\n      return <p className=\"box box-tip\">加载中……</p>;\r\n    else if (this.state.loading_status === 'failed')\r\n      return (\r\n        <div className=\"box box-tip\">\r\n          <a\r\n            onClick={() => {\r\n              this.load();\r\n            }}\r\n          >\r\n            重新加载\r\n          </a>\r\n        </div>\r\n      );\r\n    else if (this.state.loading_status === 'done')\r\n      return this.state.msg.map((msg) => (\r\n        <div className=\"box\" key={msg.timestamp}>\r\n          <div className=\"box-header\">\r\n            <Time stamp={msg.timestamp} short={false} />\r\n            <b>{msg.title}</b>\r\n          </div>\r\n          <div className=\"box-content\">\r\n            <pre>{msg.content}</pre>\r\n          </div>\r\n        </div>\r\n      ));\r\n    else return null;\r\n  }\r\n}\r\n","import React, { PureComponent } from 'react';\r\n\r\nimport './Config.css';\r\n\r\nconst BUILTIN_IMGS = {\r\n  'https://cdn.jsdelivr.net/gh/thuhole/webhole@gh-pages/static/bg/gbp.jpg':\r\n    '寻觅繁星（默认）',\r\n  'https://cdn.jsdelivr.net/gh/thuhole/webhole@gh-pages/static/bg/eriri.jpg':\r\n    '平成著名画师',\r\n  'https://cdn.jsdelivr.net/gh/thuhole/webhole@gh-pages/static/bg/yurucamp.jpg':\r\n    '露营天下第一',\r\n  'https://cdn.jsdelivr.net/gh/thuhole/webhole@gh-pages/static/bg/minecraft.jpg':\r\n    '麦恩·库拉夫特',\r\n  'https://cdn.jsdelivr.net/gh/thuhole/webhole@gh-pages/static/bg/cyberpunk.jpg':\r\n    '赛博城市',\r\n  'https://cdn.jsdelivr.net/gh/thuhole/webhole@gh-pages/static/bg/bj.jpg':\r\n    '城市的星光',\r\n  'https://cdn.jsdelivr.net/gh/thuhole/webhole@gh-pages/static/bg/sif.jpg':\r\n    '梦开始的地方',\r\n};\r\n\r\nconst DEFAULT_CONFIG = {\r\n  background_img:\r\n    'https://cdn.jsdelivr.net/gh/thuhole/webhole@gh-pages/static/bg/gbp.jpg',\r\n  background_color: '#113366',\r\n  pressure: false,\r\n  easter_egg: true,\r\n  color_scheme: 'default',\r\n  fold: true,\r\n  block_words: [],\r\n};\r\n\r\nexport function load_config() {\r\n  let config = Object.assign({}, DEFAULT_CONFIG);\r\n  let loaded_config;\r\n  try {\r\n    loaded_config = JSON.parse(localStorage['hole_config'] || '{}');\r\n  } catch (e) {\r\n    alert('设置加载失败，将重置为默认设置！\\n' + e);\r\n    delete localStorage['hole_config'];\r\n    loaded_config = {};\r\n  }\r\n\r\n  // unrecognized configs are removed\r\n  Object.keys(loaded_config).forEach((key) => {\r\n    if (config[key] !== undefined) config[key] = loaded_config[key];\r\n  });\r\n\r\n  console.log('config loaded', config);\r\n  window.config = config;\r\n}\r\nexport function save_config() {\r\n  localStorage['hole_config'] = JSON.stringify(window.config);\r\n  load_config();\r\n}\r\n\r\nexport function bgimg_style(img, color) {\r\n  if (img === undefined) img = window.config.background_img;\r\n  if (color === undefined) color = window.config.background_color;\r\n  return {\r\n    background: 'transparent center center',\r\n    backgroundImage: img === null ? 'unset' : 'url(\"' + encodeURI(img) + '\")',\r\n    backgroundColor: color,\r\n    backgroundSize: 'cover',\r\n  };\r\n}\r\n\r\nclass ConfigBackground extends PureComponent {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      img: window.config.background_img,\r\n      color: window.config.background_color,\r\n    };\r\n  }\r\n\r\n  save_changes() {\r\n    this.props.callback({\r\n      background_img: this.state.img,\r\n      background_color: this.state.color,\r\n    });\r\n  }\r\n\r\n  on_select(e) {\r\n    let value = e.target.value;\r\n    this.setState(\r\n      {\r\n        img: value === '##other' ? '' : value === '##color' ? null : value,\r\n      },\r\n      this.save_changes.bind(this),\r\n    );\r\n  }\r\n  on_change_img(e) {\r\n    this.setState(\r\n      {\r\n        img: e.target.value,\r\n      },\r\n      this.save_changes.bind(this),\r\n    );\r\n  }\r\n  on_change_color(e) {\r\n    this.setState(\r\n      {\r\n        color: e.target.value,\r\n      },\r\n      this.save_changes.bind(this),\r\n    );\r\n  }\r\n\r\n  render() {\r\n    let img_select =\r\n      this.state.img === null\r\n        ? '##color'\r\n        : Object.keys(BUILTIN_IMGS).indexOf(this.state.img) === -1\r\n        ? '##other'\r\n        : this.state.img;\r\n    return (\r\n      <div>\r\n        <p>\r\n          <b>背景图片：</b>\r\n          <select\r\n            className=\"config-select\"\r\n            value={img_select}\r\n            onChange={this.on_select.bind(this)}\r\n          >\r\n            {Object.keys(BUILTIN_IMGS).map((key) => (\r\n              <option key={key} value={key}>\r\n                {BUILTIN_IMGS[key]}\r\n              </option>\r\n            ))}\r\n            <option value=\"##other\">输入图片网址……</option>\r\n            <option value=\"##color\">纯色背景……</option>\r\n          </select>\r\n          &nbsp;\r\n          <small>#background_img</small>&nbsp;\r\n          {img_select === '##other' && (\r\n            <input\r\n              type=\"url\"\r\n              placeholder=\"图片网址\"\r\n              value={this.state.img}\r\n              onChange={this.on_change_img.bind(this)}\r\n            />\r\n          )}\r\n          {img_select === '##color' && (\r\n            <input\r\n              type=\"color\"\r\n              value={this.state.color}\r\n              onChange={this.on_change_color.bind(this)}\r\n            />\r\n          )}\r\n        </p>\r\n        <div\r\n          className=\"bg-preview\"\r\n          style={bgimg_style(this.state.img, this.state.color)}\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nclass ConfigColorScheme extends PureComponent {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      color_scheme: window.config.color_scheme,\r\n    };\r\n  }\r\n\r\n  save_changes() {\r\n    this.props.callback({\r\n      color_scheme: this.state.color_scheme,\r\n    });\r\n  }\r\n\r\n  on_select(e) {\r\n    let value = e.target.value;\r\n    this.setState(\r\n      {\r\n        color_scheme: value,\r\n      },\r\n      this.save_changes.bind(this),\r\n    );\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div>\r\n        <p>\r\n          <b>夜间模式：</b>\r\n          <select\r\n            className=\"config-select\"\r\n            value={this.state.color_scheme}\r\n            onChange={this.on_select.bind(this)}\r\n          >\r\n            <option value=\"default\">跟随系统</option>\r\n            <option value=\"light\">始终浅色模式</option>\r\n            <option value=\"dark\">始终深色模式</option>\r\n          </select>\r\n          &nbsp;<small>#color_scheme</small>\r\n        </p>\r\n        <p className=\"config-description\">\r\n          选择浅色或深色模式，深色模式下将会调暗图片亮度\r\n        </p>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nclass ConfigTextArea extends PureComponent {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      [props.id]: window.config[props.id],\r\n    };\r\n  }\r\n\r\n  save_changes() {\r\n    this.props.callback({\r\n      [this.props.id]: this.props.sift(this.state[this.props.id]),\r\n    });\r\n  }\r\n\r\n  on_change(e) {\r\n    let value = this.props.parse(e.target.value);\r\n    this.setState(\r\n      {\r\n        [this.props.id]: value,\r\n      },\r\n      this.save_changes.bind(this),\r\n    );\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div>\r\n        <label>\r\n          <p>\r\n            <b>{this.props.name}</b>&nbsp;<small>#{this.props.id}</small>\r\n          </p>\r\n          <p className=\"config-description\">{this.props.description}</p>\r\n          <textarea\r\n            name={'config-' + this.props.id}\r\n            id={`config-textarea-${this.props.id}`}\r\n            className=\"config-textarea\"\r\n            value={this.props.display(this.state[this.props.id])}\r\n            onChange={this.on_change.bind(this)}\r\n          />\r\n        </label>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\n/* class ConfigBlockWords extends PureComponent {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      block_words: window.config.block_words,\r\n    };\r\n  }\r\n\r\n  save_changes() {\r\n    this.props.callback({\r\n      block_words: this.state.block_words.filter((v) => v),\r\n    });\r\n  }\r\n\r\n  on_change(e) {\r\n    // Filter out those blank lines\r\n    let value = e.target.value.split('\\n');\r\n    this.setState(\r\n      {\r\n        block_words: value,\r\n      },\r\n      this.save_changes.bind(this),\r\n    );\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div>\r\n        <p>\r\n          {' '}\r\n          <b>设置屏蔽词 </b>\r\n        </p>\r\n        <p>\r\n          <textarea\r\n            className=\"block-words\"\r\n            value={this.state.block_words.join('\\n')}\r\n            onChange={this.on_change.bind(this)}\r\n          />\r\n        </p>\r\n      </div>\r\n    );\r\n  }\r\n} */\r\n\r\nclass ConfigSwitch extends PureComponent {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      switch: window.config[this.props.id],\r\n    };\r\n  }\r\n\r\n  on_change(e) {\r\n    let val = e.target.checked;\r\n    this.setState(\r\n      {\r\n        switch: val,\r\n      },\r\n      () => {\r\n        this.props.callback({\r\n          [this.props.id]: val,\r\n        });\r\n      },\r\n    );\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div>\r\n        <p>\r\n          <label>\r\n            <input\r\n              name={'config-' + this.props.id}\r\n              type=\"checkbox\"\r\n              checked={this.state.switch}\r\n              onChange={this.on_change.bind(this)}\r\n            />\r\n            &nbsp;<b>{this.props.name}</b>\r\n            &nbsp;<small>#{this.props.id}</small>\r\n          </label>\r\n        </p>\r\n        <p className=\"config-description\">{this.props.description}</p>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport class ConfigUI extends PureComponent {\r\n  constructor(props) {\r\n    super(props);\r\n    this.save_changes_bound = this.save_changes.bind(this);\r\n  }\r\n\r\n  save_changes(chg) {\r\n    console.log(chg);\r\n    Object.keys(chg).forEach((key) => {\r\n      window.config[key] = chg[key];\r\n    });\r\n    save_config();\r\n  }\r\n\r\n  reset_settings() {\r\n    if (window.confirm('重置所有设置？')) {\r\n      window.config = {};\r\n      save_config();\r\n      window.location.reload();\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div>\r\n        <div className=\"box config-ui-header\">\r\n          <p>\r\n            这些功能仍在测试，可能不稳定（\r\n            <a onClick={this.reset_settings.bind(this)}>全部重置</a>）\r\n          </p>\r\n          <p>\r\n            <b>\r\n              修改设置后{' '}\r\n              <a\r\n                onClick={() => {\r\n                  window.location.reload();\r\n                }}\r\n              >\r\n                刷新页面\r\n              </a>{' '}\r\n              方可生效\r\n            </b>\r\n          </p>\r\n        </div>\r\n        <div className=\"box\">\r\n          <ConfigBackground\r\n            id=\"background\"\r\n            callback={this.save_changes_bound}\r\n          />\r\n          <hr />\r\n          <ConfigColorScheme\r\n            id=\"color-scheme\"\r\n            callback={this.save_changes_bound}\r\n          />\r\n          <hr />\r\n          {/* <ConfigBlockWords\r\n            id=\"block-words\"\r\n            callback={this.save_changes_bound}\r\n          /> */}\r\n          <ConfigTextArea\r\n            id=\"block_words\"\r\n            callback={this.save_changes_bound}\r\n            name=\"设置屏蔽词\"\r\n            description={'包含屏蔽词的树洞会被折叠，每行写一个屏蔽词'}\r\n            display={(array) => array.join('\\n')}\r\n            sift={(array) => array.filter((v) => v)}\r\n            parse={(string) => string.split('\\n')}\r\n          />\r\n          <hr />\r\n          <ConfigSwitch\r\n            callback={this.save_changes_bound}\r\n            id=\"pressure\"\r\n            name=\"快速返回\"\r\n            description=\"短暂按住 Esc 键或重压屏幕（3D Touch）可以快速返回或者刷新树洞\"\r\n          />\r\n          <hr />\r\n          <ConfigSwitch\r\n            callback={this.save_changes_bound}\r\n            id=\"easter_egg\"\r\n            name=\"允许彩蛋\"\r\n            description=\"在某些情况下显示彩蛋\"\r\n          />\r\n          <hr />\r\n          <ConfigSwitch\r\n            callback={this.save_changes_bound}\r\n            id=\"fold\"\r\n            name=\"折叠树洞\"\r\n            description=\"在时间线中折叠可能引起不适的树洞\"\r\n          />\r\n          <hr />\r\n          <p>\r\n            新功能建议或问题反馈请在&nbsp;\r\n            <a\r\n              href=\"https://github.com/thuhole/thuhole-go-backend/issues\"\r\n              target=\"_blank\"\r\n            >\r\n              GitHub <span className=\"icon icon-github\" />\r\n            </a>\r\n            &nbsp;提出。\r\n          </p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import React, { Component } from 'react';\r\nimport {\r\n  API_BASE,\r\n  SafeTextarea,\r\n  PromotionBar,\r\n  HighlightedMarkdown,\r\n} from './Common';\r\nimport { MessageViewer } from './Message';\r\nimport { LoginPopup } from './infrastructure/widgets';\r\nimport { ColorPicker } from './color_picker';\r\nimport { ConfigUI } from './Config';\r\nimport fixOrientation from 'fix-orientation';\r\nimport copy from 'copy-to-clipboard';\r\nimport { cache } from './cache';\r\nimport {\r\n  API_VERSION_PARAM,\r\n  THUHOLE_API_ROOT,\r\n  API,\r\n  get_json,\r\n  token_param,\r\n} from './flows_api';\r\n\r\nimport './UserAction.css';\r\n\r\nconst BASE64_RATE = 4 / 3;\r\nconst MAX_IMG_DIAM = 8000;\r\nconst MAX_IMG_PX = 5000000;\r\nconst MAX_IMG_FILESIZE = 450000 * BASE64_RATE;\r\n\r\nexport const TokenCtx = React.createContext({\r\n  value: null,\r\n  set_value: () => {},\r\n});\r\n\r\n// class LifeInfoBox extends Component {\r\n//     constructor(props) {\r\n//         super(props);\r\n//         if(!window._life_info_cache)\r\n//             window._life_info_cache={};\r\n//         this.CACHE_TIMEOUT_S=15;\r\n//         this.state={\r\n//             today_info: this.cache_get('today_info'),\r\n//             card_balance: this.cache_get('card_balance'),\r\n//             net_balance: this.cache_get('net_balance'),\r\n//             mail_count: this.cache_get('mail_count'),\r\n//         };\r\n//         this.INTERNAL_NETWORK_FAILURE='_network_failure';\r\n//         this.API_NAME={\r\n//             today_info: 'hole/today_info',\r\n//             card_balance: 'isop/card_balance',\r\n//             net_balance: 'isop/net_balance',\r\n//             mail_count: 'isop/mail_count',\r\n//         };\r\n//     }\r\n//\r\n//     cache_get(key) {\r\n//         let cache_item=window._life_info_cache[key];\r\n//         if(!cache_item || (+new Date())-cache_item[0]>1000*this.CACHE_TIMEOUT_S)\r\n//             return null;\r\n//         else\r\n//             return cache_item[1];\r\n//     }\r\n//     cache_set(key,value) {\r\n//         if(!window._life_info_cache[key] || window._life_info_cache[key][1]!==value)\r\n//             window._life_info_cache[key]=[+new Date(),value];\r\n//     }\r\n//\r\n//     load(state_key) {\r\n//         this.setState({\r\n//             [state_key]: null,\r\n//         },()=>{\r\n//             fetch(\r\n//                 PKUHELPER_ROOT+'api_xmcp/'+this.API_NAME[state_key]\r\n//                 +'?user_token='+encodeURIComponent(this.props.token)\r\n//                 +API_VERSION_PARAM()\r\n//             )\r\n//                 .then(get_json)\r\n//                 .then((json)=>{\r\n//                     //console.log(json);\r\n//                     this.setState({\r\n//                         [state_key]: json,\r\n//                     });\r\n//                 })\r\n//                 .catch((e)=>{\r\n//                     this.setState({\r\n//                         [state_key]: {\r\n//                             errMsg: '网络错误 '+e,\r\n//                             errCode: this.INTERNAL_NETWORK_FAILURE,\r\n//                             success: false,\r\n//                         }\r\n//                     });\r\n//                 })\r\n//         });\r\n//     }\r\n//\r\n//     componentDidMount() {\r\n//         ['today_info','card_balance','net_balance','mail_count'].forEach((k)=>{\r\n//             if(!this.state[k])\r\n//                 this.load(k);\r\n//         });\r\n//     }\r\n//\r\n//     reload_all() {\r\n//         ['today_info','card_balance','net_balance','mail_count'].forEach((k)=>{\r\n//             this.load(k);\r\n//         });\r\n//     }\r\n//\r\n//     render_line(state_key,title,value_fn,action,url_fn,do_login) {\r\n//         let s=this.state[state_key];\r\n//         if(!s)\r\n//             return (\r\n//                 <tr>\r\n//                     <td>{title}</td>\r\n//                     <td>加载中……</td>\r\n//                     <td />\r\n//                 </tr>\r\n//             );\r\n//         else if(!s.success) {\r\n//             let type='加载失败';\r\n//             if(s.errCode===this.INTERNAL_NETWORK_FAILURE)\r\n//                 type='网络错误';\r\n//             else if(['E01','E02','E03'].indexOf(s.errCode)!==-1)\r\n//                 type='授权失效';\r\n//\r\n//             let details=JSON.stringify(s);\r\n//             if(s.errMsg)\r\n//                 details=s.errMsg;\r\n//             else if(s.error)\r\n//                 details=s.error;\r\n//\r\n//             return (\r\n//                 <tr>\r\n//                     <td>{title}</td>\r\n//                     <td className=\"life-info-error\">\r\n//                         <a onClick={()=>alert(details)}>{type}</a>\r\n//                     </td>\r\n//                     <td>\r\n//                         {type==='授权失效' ?\r\n//                             <a onClick={do_login}>\r\n//                                 <span className=\"icon icon-forward\" />&nbsp;重新登录\r\n//                             </a> :\r\n//                             <a onClick={()=>this.load(state_key)}>\r\n//                                 <span className=\"icon icon-forward\" />&nbsp;重试\r\n//                             </a>\r\n//                         }\r\n//                     </td>\r\n//                 </tr>\r\n//             )\r\n//         }\r\n//         else {\r\n//             this.cache_set(state_key,s);\r\n//\r\n//             return (\r\n//                 <tr>\r\n//                     <td>{title}</td>\r\n//                     <td>{value_fn(s)}</td>\r\n//                     <td>\r\n//                         <a href={url_fn(s)} target=\"_blank\">\r\n//                             <span className=\"icon icon-forward\" />&nbsp;{action}\r\n//                         </a>\r\n//                     </td>\r\n//                 </tr>\r\n//             );\r\n//         }\r\n//     }\r\n//\r\n//     render() {\r\n//         return (\r\n//             <LoginPopup token_callback={(t)=>{\r\n//                 this.props.set_token(t);\r\n//                 this.reload_all();\r\n//             }}>{(do_login)=>(\r\n//                 <div className=\"box\">\r\n//                     <table className=\"life-info-table\">\r\n//                         <tbody>\r\n//                             {this.render_line(\r\n//                                 'today_info',\r\n//                                 '今日',(s)=>s.info,\r\n//                                 '校历',(s)=>s.schedule_url,\r\n//                                 do_login,\r\n//                             )}\r\n//                             {this.render_line(\r\n//                                 'card_balance',\r\n//                                 '校园卡',(s)=>`余额￥${s.balance.toFixed(2)}`,\r\n//                                 '充值',()=>'https://virtualprod.alipay.com/educate/educatePcRecharge.htm?schoolCode=PKU&schoolName=',\r\n//                                 do_login,\r\n//                             )}\r\n//                             {this.render_line(\r\n//                                 'net_balance',\r\n//                                 '网费',(s)=>`余额￥${s.balance.toFixed(2)}`,\r\n//                                 '充值',()=>'https://its.pku.edu.cn/epay.jsp',\r\n//                                 do_login,\r\n//                             )}\r\n//                             {this.render_line(\r\n//                                 'mail_count',\r\n//                                 '邮件',(s)=>`未读 ${s.count} 封`,\r\n//                                 '查看',()=>'https://mail.pku.edu.cn/',\r\n//                                 do_login,\r\n//                             )}\r\n//                         </tbody>\r\n//                     </table>\r\n//                 </div>\r\n//             )}</LoginPopup>\r\n//         )\r\n//     }\r\n// }\r\n\r\nexport function InfoSidebar(props) {\r\n  return (\r\n    <div>\r\n      <PromotionBar />\r\n      <LoginForm show_sidebar={props.show_sidebar} />\r\n      <div className=\"box list-menu\">\r\n        <a\r\n          onClick={() => {\r\n            props.show_sidebar('设置', <ConfigUI />);\r\n          }}\r\n        >\r\n          <span className=\"icon icon-settings\" />\r\n          <label>设置</label>\r\n        </a>\r\n        &nbsp;&nbsp;\r\n        <a href=\"https://thuhole.com/policy.html\" target=\"_blank\">\r\n          <span className=\"icon icon-textfile\" />\r\n          <label>树洞规范</label>\r\n        </a>\r\n        &nbsp;&nbsp;\r\n        <a\r\n          href=\"https://github.com/thuhole/thuhole-go-backend/issues\"\r\n          target=\"_blank\"\r\n        >\r\n          <span className=\"icon icon-github\" />\r\n          <label>意见反馈</label>\r\n        </a>\r\n      </div>\r\n      <div className=\"box help-desc-box\">\r\n        <p>\r\n          <a\r\n            onClick={() => {\r\n              if ('serviceWorker' in navigator) {\r\n                navigator.serviceWorker\r\n                  .getRegistrations()\r\n                  .then((registrations) => {\r\n                    for (let registration of registrations) {\r\n                      console.log('unregister', registration);\r\n                      registration.unregister();\r\n                    }\r\n                  });\r\n              }\r\n              cache().clear();\r\n              setTimeout(() => {\r\n                window.location.reload(true);\r\n              }, 200);\r\n            }}\r\n          >\r\n            强制检查更新\r\n          </a>\r\n          （当前版本：【{process.env.REACT_APP_BUILD_INFO || '---'}{' '}\r\n          {process.env.NODE_ENV}】 会自动在后台检查更新并在下次访问时更新）\r\n        </p>\r\n      </div>\r\n      <div className=\"box help-desc-box\">\r\n        <p>联系我们：thuhole at protonmail dot com</p>\r\n      </div>\r\n      <div className=\"box help-desc-box\">\r\n        <p>\r\n          T大树洞 网页版 by @thuhole， 基于&nbsp;\r\n          <a\r\n            href=\"https://www.gnu.org/licenses/gpl-3.0.zh-cn.html\"\r\n            target=\"_blank\"\r\n          >\r\n            GPLv3\r\n          </a>\r\n          &nbsp;协议在{' '}\r\n          <a href=\"https://github.com/thuhole/webhole\" target=\"_blank\">\r\n            GitHub\r\n          </a>{' '}\r\n          开源\r\n        </p>\r\n        <p>\r\n          T大树洞 网页版的诞生离不开&nbsp;\r\n          <a\r\n            href=\"https://github.com/pkuhelper-web/webhole\"\r\n            target=\"_blank\"\r\n            rel=\"noopener\"\r\n          >\r\n            P大树洞网页版 by @xmcp\r\n          </a>\r\n          、\r\n          <a href=\"https://reactjs.org/\" target=\"_blank\" rel=\"noopener\">\r\n            React\r\n          </a>\r\n          、\r\n          <a href=\"https://icomoon.io/#icons\" target=\"_blank\" rel=\"noopener\">\r\n            IcoMoon\r\n          </a>\r\n          &nbsp;等开源项目\r\n        </p>\r\n        <p>\r\n          This program is free software: you can redistribute it and/or modify\r\n          it under the terms of the GNU General Public License as published by\r\n          the Free Software Foundation, either version 3 of the License, or (at\r\n          your option) any later version.\r\n        </p>\r\n        <p>\r\n          This program is distributed in the hope that it will be useful, but\r\n          WITHOUT ANY WARRANTY; without even the implied warranty of\r\n          MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the&nbsp;\r\n          <a\r\n            href=\"https://www.gnu.org/licenses/gpl-3.0.zh-cn.html\"\r\n            target=\"_blank\"\r\n          >\r\n            GNU General Public License\r\n          </a>\r\n          &nbsp;for more details.\r\n        </p>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nclass ResetUsertokenWidget extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      loading_status: 'done',\r\n    };\r\n  }\r\n\r\n  do_reset() {\r\n    if (\r\n      window.confirm(\r\n        '您正在重置 UserToken！\\n您的账号将会在【所有设备】上注销，您需要手动重新登录！',\r\n      )\r\n    ) {\r\n      let uid = window.prompt(\r\n        '您正在重置 UserToken！\\n请输入您的学号以确认身份：',\r\n      );\r\n      if (uid)\r\n        this.setState(\r\n          {\r\n            loading_status: 'loading',\r\n          },\r\n          () => {\r\n            fetch(THUHOLE_API_ROOT + 'api_xmcp/hole/reset_usertoken', {\r\n              method: 'post',\r\n              headers: {\r\n                'Content-Type': 'application/json',\r\n              },\r\n              body: JSON.stringify({\r\n                user_token: this.props.token,\r\n                uid: uid,\r\n              }),\r\n            })\r\n              .then(get_json)\r\n              .then((json) => {\r\n                if (json.error) throw new Error(json.error);\r\n                else alert('重置成功！您需要在所有设备上重新登录。');\r\n\r\n                this.setState({\r\n                  loading_status: 'done',\r\n                });\r\n              })\r\n              .catch((e) => {\r\n                alert('重置失败：' + e);\r\n                this.setState({\r\n                  loading_status: 'done',\r\n                });\r\n              });\r\n          },\r\n        );\r\n    }\r\n  }\r\n\r\n  render() {\r\n    if (this.state.loading_status === 'done')\r\n      return <a onClick={this.do_reset.bind(this)}>重置</a>;\r\n    else if (this.state.loading_status === 'loading')\r\n      return (\r\n        <a>\r\n          <span className=\"icon icon-loading\" />\r\n        </a>\r\n      );\r\n  }\r\n}\r\n\r\nexport class LoginForm extends Component {\r\n  copy_token(token) {\r\n    if (copy(token)) alert('复制成功！\\n请一定不要泄露给其他人，或在thuhole.com以外的其他网站中输入token，否则可能会导致信息泄漏哦');\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <TokenCtx.Consumer>\r\n        {(token) => (\r\n          <div>\r\n            {/*{!!token.value &&*/}\r\n            {/*    <LifeInfoBox token={token.value} set_token={token.set_value} />*/}\r\n            {/*}*/}\r\n            <div className=\"login-form box\">\r\n              {token.value ? (\r\n                <div>\r\n                  <p>\r\n                    <b>您已登录。</b>\r\n                    <button\r\n                      type=\"button\"\r\n                      onClick={() => {\r\n                        token.set_value(null);\r\n                      }}\r\n                    >\r\n                      <span className=\"icon icon-logout\" /> 注销\r\n                    </button>\r\n                    <br />\r\n                  </p>\r\n                  {/*<p>*/}\r\n                  {/*根据计算中心要求，访问授权三个月内有效，过期需重新登录。*/}\r\n                  {/*T大树洞将会单向加密(i.e. 哈希散列)您的邮箱后再存入数据库，因此您的发帖具有较强的匿名性。具体可见我们的<a href=\"https://github.com/thuhole/thuhole-go-backend/blob/76f56e6b75257b59e552b6bdba77e114151fcad1/src/db.go#L184\">后端开源代码</a>。*/}\r\n                  {/*</p>*/}\r\n                  <p>\r\n                    <a\r\n                      onClick={() => {\r\n                        this.props.show_sidebar(\r\n                          '系统消息',\r\n                          <MessageViewer token={token.value} />,\r\n                        );\r\n                      }}\r\n                    >\r\n                      查看系统消息\r\n                    </a>\r\n                    <br />\r\n                    当您发送的内容违规时，我们将用系统消息提示您\r\n                  </p>\r\n                  <p>\r\n                    <a onClick={this.copy_token.bind(this, token.value)}>\r\n                      复制 User Token\r\n                    </a>\r\n                    <br />\r\n                    复制 User Token\r\n                    可以在新设备登录，切勿告知他人。若怀疑被盗号请重新邮箱验证码登录以重置Token。\r\n                    {/*，若怀疑被盗号请尽快 <ResetUsertokenWidget token={token.value} />*/}\r\n                  </p>\r\n                </div>\r\n              ) : (\r\n                <LoginPopup token_callback={token.set_value}>\r\n                  {(do_popup) => (\r\n                    <div>\r\n                      <p>\r\n                        <button type=\"button\" onClick={do_popup}>\r\n                          <span className=\"icon icon-login\" />\r\n                          &nbsp;登录\r\n                        </button>\r\n                      </p>\r\n                      <p>\r\n                        <small>\r\n                          T大树洞\r\n                          面向T大学生，通过T大邮箱验证您的身份并提供服务。\r\n                        </small>\r\n                      </p>\r\n                    </div>\r\n                  )}\r\n                </LoginPopup>\r\n              )}\r\n            </div>\r\n          </div>\r\n        )}\r\n      </TokenCtx.Consumer>\r\n    );\r\n  }\r\n}\r\n\r\n// export class ReplyForm extends Component {\r\n//   constructor(props) {\r\n//     super(props);\r\n//     this.state = {\r\n//       text: '',\r\n//       loading_status: 'done',\r\n//       preview: false,\r\n//     };\r\n//     this.on_change_bound = this.on_change.bind(this);\r\n//     this.area_ref = this.props.area_ref || React.createRef();\r\n//     this.global_keypress_handler_bound = this.global_keypress_handler.bind(\r\n//       this,\r\n//     );\r\n//     this.color_picker = new ColorPicker();\r\n//   }\r\n//\r\n//   global_keypress_handler(e) {\r\n//     if (\r\n//       e.code === 'Enter' &&\r\n//       !e.ctrlKey &&\r\n//       !e.altKey &&\r\n//       ['input', 'textarea'].indexOf(e.target.tagName.toLowerCase()) === -1\r\n//     ) {\r\n//       if (this.area_ref.current) {\r\n//         e.preventDefault();\r\n//         this.area_ref.current.focus();\r\n//       }\r\n//     }\r\n//   }\r\n//   componentDidMount() {\r\n//     document.addEventListener('keypress', this.global_keypress_handler_bound);\r\n//   }\r\n//   componentWillUnmount() {\r\n//     document.removeEventListener(\r\n//       'keypress',\r\n//       this.global_keypress_handler_bound,\r\n//     );\r\n//   }\r\n//\r\n//   on_change(value) {\r\n//     this.setState({\r\n//       text: value,\r\n//     });\r\n//   }\r\n//\r\n//   on_submit(event) {\r\n//     if (event) event.preventDefault();\r\n//     if (this.state.loading_status === 'loading') return;\r\n//     this.setState({\r\n//       loading_status: 'loading',\r\n//     });\r\n//\r\n//     let data = new URLSearchParams();\r\n//     data.append('pid', this.props.pid);\r\n//     data.append('text', this.state.text);\r\n//     data.append('user_token', this.props.token);\r\n//     fetch(\r\n//       API_BASE + '/api.php?action=docomment' + token_param(this.props.token),\r\n//       {\r\n//         method: 'POST',\r\n//         headers: {\r\n//           'Content-Type': 'application/x-www-form-urlencoded',\r\n//         },\r\n//         body: data,\r\n//       },\r\n//     )\r\n//       .then(get_json)\r\n//       .then((json) => {\r\n//         if (json.code !== 0) {\r\n//           if (json.msg) alert(json.msg);\r\n//           throw new Error(JSON.stringify(json));\r\n//         }\r\n//\r\n//         this.setState({\r\n//           loading_status: 'done',\r\n//           text: '',\r\n//           preview: false,\r\n//         });\r\n//         this.area_ref.current.clear();\r\n//         this.props.on_complete();\r\n//       })\r\n//       .catch((e) => {\r\n//         console.error(e);\r\n//         alert('回复失败');\r\n//         this.setState({\r\n//           loading_status: 'done',\r\n//         });\r\n//       });\r\n//   }\r\n//\r\n//   toggle_preview() {\r\n//     this.setState({\r\n//       preview: !this.state.preview,\r\n//     });\r\n//   }\r\n//\r\n//   render() {\r\n//     return (\r\n//       <form\r\n//         onSubmit={this.on_submit.bind(this)}\r\n//         className={'reply-form box' + (this.state.text ? ' reply-sticky' : '')}\r\n//       >\r\n//         {this.state.preview ? (\r\n//           <div className=\"reply-preview\">\r\n//             <HighlightedMarkdown\r\n//               text={this.state.text}\r\n//               color_picker={this.color_picker}\r\n//               show_pid={() => {}}\r\n//             />\r\n//           </div>\r\n//         ) : (\r\n//           <SafeTextarea\r\n//             ref={this.area_ref}\r\n//             id={this.props.pid}\r\n//             on_change={this.on_change_bound}\r\n//             on_submit={this.on_submit.bind(this)}\r\n//           />\r\n//         )}\r\n//         <button\r\n//           type=\"button\"\r\n//           onClick={() => {\r\n//             this.toggle_preview();\r\n//           }}\r\n//         >\r\n//           {this.state.preview ? (\r\n//             <span className=\"icon icon-eye-blocked\" />\r\n//           ) : (\r\n//             <span className=\"icon icon-eye\" />\r\n//           )}\r\n//         </button>\r\n//         {this.state.loading_status === 'loading' ? (\r\n//           <button disabled=\"disabled\">\r\n//             <span className=\"icon icon-loading\" />\r\n//           </button>\r\n//         ) : (\r\n//           <button type=\"submit\">\r\n//             <span className=\"icon icon-send\" />\r\n//           </button>\r\n//         )}\r\n//       </form>\r\n//     );\r\n//   }\r\n// }\r\n\r\nexport class PostForm extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      text: '',\r\n      loading_status: 'done',\r\n      img_tip: null,\r\n      preview: false,\r\n    };\r\n    this.img_ref = React.createRef();\r\n    this.area_ref = this.props.area_ref || React.createRef();\r\n    this.on_change_bound = this.on_change.bind(this);\r\n    this.on_img_change_bound = this.on_img_change.bind(this);\r\n    this.global_keypress_handler_bound = this.global_keypress_handler.bind(\r\n      this,\r\n    );\r\n    this.color_picker = new ColorPicker();\r\n  }\r\n\r\n  global_keypress_handler(e) {\r\n    if (\r\n      e.code === 'Enter' &&\r\n      !e.ctrlKey &&\r\n      !e.altKey &&\r\n      ['input', 'textarea'].indexOf(e.target.tagName.toLowerCase()) === -1\r\n    ) {\r\n      if (this.area_ref.current) {\r\n        e.preventDefault();\r\n        this.area_ref.current.focus();\r\n      }\r\n    }\r\n  }\r\n  componentDidMount() {\r\n    document.addEventListener('keypress', this.global_keypress_handler_bound);\r\n  }\r\n  componentWillUnmount() {\r\n    document.removeEventListener(\r\n      'keypress',\r\n      this.global_keypress_handler_bound,\r\n    );\r\n  }\r\n\r\n  on_change(value) {\r\n    this.setState({\r\n      text: value,\r\n    });\r\n  }\r\n\r\n  do_post(text, img) {\r\n    let data = new URLSearchParams();\r\n    if (this.props.action === 'docomment') {\r\n      data.append('pid', this.props.pid);\r\n    }\r\n    data.append('text', this.state.text);\r\n    data.append('type', img ? 'image' : 'text');\r\n    data.append('user_token', this.props.token);\r\n    if (img) data.append('data', img);\r\n\r\n    fetch(\r\n      API_BASE +\r\n        '/api.php?action=' +\r\n        this.props.action +\r\n        token_param(this.props.token),\r\n      {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/x-www-form-urlencoded',\r\n        },\r\n        body: data,\r\n      })\r\n      .then(get_json)\r\n      .then((json) => {\r\n        if (json.code !== 0) {\r\n          if (json.msg) alert(json.msg);\r\n          throw new Error(JSON.stringify(json));\r\n        }\r\n\r\n        this.setState({\r\n          loading_status: 'done',\r\n          text: '',\r\n          preview: false,\r\n        });\r\n        this.area_ref.current.clear();\r\n        this.props.on_complete();\r\n      })\r\n      .catch((e) => {\r\n        console.error(e);\r\n        alert('发表失败');\r\n        this.setState({\r\n          loading_status: 'done',\r\n        });\r\n      });\r\n  }\r\n\r\n  proc_img(file) {\r\n    return new Promise((resolve, reject) => {\r\n      function return_url(url) {\r\n        const idx = url.indexOf(';base64,');\r\n        if (idx === -1) throw new Error('img not base64 encoded');\r\n\r\n        return url.substr(idx + 8);\r\n      }\r\n\r\n      let reader = new FileReader();\r\n      function on_got_img(url) {\r\n        const image = new Image();\r\n        image.onload = () => {\r\n          let width = image.width;\r\n          let height = image.height;\r\n          let compressed = false;\r\n\r\n          if (width > MAX_IMG_DIAM) {\r\n            height = (height * MAX_IMG_DIAM) / width;\r\n            width = MAX_IMG_DIAM;\r\n            compressed = true;\r\n          }\r\n          if (height > MAX_IMG_DIAM) {\r\n            width = (width * MAX_IMG_DIAM) / height;\r\n            height = MAX_IMG_DIAM;\r\n            compressed = true;\r\n          }\r\n          if (height * width > MAX_IMG_PX) {\r\n            let rate = Math.sqrt((height * width) / MAX_IMG_PX);\r\n            height /= rate;\r\n            width /= rate;\r\n            compressed = true;\r\n          }\r\n          console.log('chosen img size', width, height);\r\n\r\n          let canvas = document.createElement('canvas');\r\n          let ctx = canvas.getContext('2d');\r\n          canvas.width = width;\r\n          canvas.height = height;\r\n          ctx.drawImage(image, 0, 0, width, height);\r\n\r\n          let quality_l = 0.1,\r\n            quality_r = 0.9,\r\n            quality,\r\n            new_url;\r\n          while (quality_r - quality_l >= 0.03) {\r\n            quality = (quality_r + quality_l) / 2;\r\n            new_url = canvas.toDataURL('image/jpeg', quality);\r\n            console.log(\r\n              quality_l,\r\n              quality_r,\r\n              'trying quality',\r\n              quality,\r\n              'size',\r\n              new_url.length,\r\n            );\r\n            if (new_url.length <= MAX_IMG_FILESIZE) quality_l = quality;\r\n            else quality_r = quality;\r\n          }\r\n          if (quality_l >= 0.101) {\r\n            console.log('chosen img quality', quality);\r\n            resolve({\r\n              img: return_url(new_url),\r\n              quality: quality,\r\n              width: Math.round(width),\r\n              height: Math.round(height),\r\n              compressed: compressed,\r\n            });\r\n          } else {\r\n            reject('图片过大，无法上传');\r\n          }\r\n        };\r\n        image.src = url;\r\n      }\r\n      reader.onload = (event) => {\r\n        fixOrientation(event.target.result, {}, (fixed_dataurl) => {\r\n          on_got_img(fixed_dataurl);\r\n        });\r\n      };\r\n      reader.readAsDataURL(file);\r\n    });\r\n  }\r\n\r\n  on_img_change() {\r\n    if (this.img_ref.current && this.img_ref.current.files.length)\r\n      this.setState(\r\n        {\r\n          img_tip: '（正在处理图片……）',\r\n        },\r\n        () => {\r\n          this.proc_img(this.img_ref.current.files[0])\r\n            .then((d) => {\r\n              this.setState({\r\n                img_tip:\r\n                  `（${d.compressed ? '压缩到' : '尺寸'} ${d.width}*${\r\n                    d.height\r\n                  } / ` +\r\n                  `质量 ${Math.floor(d.quality * 100)}% / ${Math.floor(\r\n                    d.img.length / BASE64_RATE / 1000,\r\n                  )}KB）`,\r\n              });\r\n            })\r\n            .catch((e) => {\r\n              this.setState({\r\n                img_tip: `图片无效：${e}`,\r\n              });\r\n            });\r\n        },\r\n      );\r\n    else\r\n      this.setState({\r\n        img_tip: null,\r\n      });\r\n  }\r\n\r\n  on_submit(event) {\r\n    if (event) event.preventDefault();\r\n    if (this.state.loading_status === 'loading') return;\r\n    if (this.state.text.includes('自杀')) {\r\n        const msg = [\r\n            '您提到了「自杀」\\n',\r\n            '需要帮助？',\r\n            '北京24小时心理援助热线：010-8295-1332',\r\n            '希望24小时热线：400-161-9995',\r\n            '你不孤单，我们都在。\\n',\r\n            '确认将继续发表'\r\n        ]\r\n        const result = confirm(msg.join('\\n'))\r\n        if (result !== true) return\r\n    }\r\n    if (this.img_ref.current.files.length) {\r\n      this.setState({\r\n        loading_status: 'processing',\r\n      });\r\n      this.proc_img(this.img_ref.current.files[0])\r\n        .then((d) => {\r\n          this.setState({\r\n            loading_status: 'loading',\r\n          });\r\n          this.do_post(this.state.text, d.img);\r\n        })\r\n        .catch((e) => {\r\n          alert(e);\r\n        });\r\n    } else {\r\n      this.setState({\r\n        loading_status: 'loading',\r\n      });\r\n      this.do_post(this.state.text, null);\r\n    }\r\n  }\r\n\r\n  toggle_preview() {\r\n    this.setState({\r\n      preview: !this.state.preview,\r\n    });\r\n  }\r\n\r\n  render() {\r\n    let replyClassName =\r\n      'reply-form box' + (this.state.text ? ' reply-sticky' : '');\r\n    return (\r\n      <form\r\n        onSubmit={this.on_submit.bind(this)}\r\n        className={\r\n          this.props.action === 'dopost' ? 'post-form box' : replyClassName\r\n        }\r\n      >\r\n        <div className=\"post-form-bar\">\r\n          <label>\r\n            {/*<a>上传图片</a>*/}\r\n            <span className={'post-upload'}>\r\n              <span className=\"icon icon-upload\" />\r\n              &nbsp;插入图片\r\n            </span>\r\n            <input\r\n              ref={this.img_ref}\r\n              type=\"file\"\r\n              accept=\"image/*\"\r\n              disabled={this.state.loading_status !== 'done'}\r\n              onChange={this.on_img_change_bound}\r\n            />\r\n          </label>\r\n\r\n          {this.state.preview ? (\r\n            <button\r\n              type=\"button\"\r\n              onClick={() => {\r\n                this.toggle_preview();\r\n              }}\r\n            >\r\n              <span className=\"icon icon-eye-blocked\" />\r\n              &nbsp;编辑\r\n            </button>\r\n          ) : (\r\n            <button\r\n              type=\"button\"\r\n              onClick={() => {\r\n                this.toggle_preview();\r\n              }}\r\n            >\r\n              <span className=\"icon icon-eye\" />\r\n              &nbsp;预览\r\n            </button>\r\n          )}\r\n\r\n          {this.state.loading_status !== 'done' ? (\r\n            <button disabled=\"disabled\">\r\n              <span className=\"icon icon-loading\" />\r\n              &nbsp;\r\n              {this.state.loading_status === 'processing' ? '处理' : '上传'}\r\n            </button>\r\n          ) : (\r\n            <button type=\"submit\">\r\n              <span className=\"icon icon-send\" />\r\n              &nbsp;发表\r\n            </button>\r\n          )}\r\n        </div>\r\n        {!!this.state.img_tip && (\r\n          <p className=\"post-form-img-tip\">\r\n            <a\r\n              onClick={() => {\r\n                this.img_ref.current.value = '';\r\n                this.on_img_change();\r\n              }}\r\n            >\r\n              删除图片\r\n            </a>\r\n            {this.state.img_tip}\r\n          </p>\r\n        )}\r\n        {this.state.preview ? (\r\n          <div className={this.props.action === 'dopost' ? \"post-preview\" : \"reply-preview\"}>\r\n            <HighlightedMarkdown\r\n              text={this.state.text}\r\n              color_picker={this.color_picker}\r\n              show_pid={() => {}}\r\n            />\r\n          </div>\r\n        ) : (\r\n          <SafeTextarea\r\n            ref={this.area_ref}\r\n            id={this.props.pid}\r\n            on_change={this.on_change_bound}\r\n            on_submit={this.on_submit.bind(this)}\r\n          />\r\n        )}\r\n        {this.props.action === 'dopost' && (\r\n          <p>\r\n            <small>\r\n              发帖前请阅读并同意\r\n              <a href=\"https://thuhole.com/policy.html\" target=\"_blank\">\r\n                树洞规范\r\n              </a>\r\n            </small>\r\n          </p>\r\n        )}\r\n      </form>\r\n    );\r\n  }\r\n}\r\n","import React, { PureComponent } from 'react';\r\nimport copy from 'copy-to-clipboard';\r\nimport { ColorPicker } from './color_picker';\r\nimport {\r\n  split_text,\r\n  NICKNAME_RE,\r\n  PID_RE,\r\n  URL_RE,\r\n  URL_PID_RE,\r\n} from './text_splitter';\r\nimport {\r\n  format_time,\r\n  build_highlight_re,\r\n  Time,\r\n  TitleLine,\r\n  HighlightedText,\r\n  ClickHandler,\r\n  ColoredSpan,\r\n  HighlightedMarkdown,\r\n} from './Common';\r\nimport './Flows.css';\r\nimport LazyLoad, { forceCheck } from './react-lazyload/src';\r\nimport { AudioWidget } from './AudioWidget';\r\nimport {TokenCtx, ReplyForm, PostForm} from './UserAction';\r\n\r\nimport { API } from './flows_api';\r\n\r\nconst IMAGE_BASE = 'https://thimg.yecdn.com/';\r\nconst IMAGE_BAK_BASE = 'https://img2.thuhole.com/';\r\n// const AUDIO_BASE=THUHOLE_API_ROOT+'services/thuhole/audios/';\r\n\r\nconst CLICKABLE_TAGS = { a: true, audio: true };\r\nconst PREVIEW_REPLY_COUNT = 10;\r\n// const QUOTE_BLACKLIST=['23333','233333','66666','666666','10086','10000','100000','99999','999999','55555','555555'];\r\nconst QUOTE_BLACKLIST = [];\r\nconst FOLD_TAGS = [\r\n  '性相关',\r\n  '政治相关',\r\n  '性话题',\r\n  '政治话题',\r\n  '折叠',\r\n  'NSFW',\r\n  '刷屏',\r\n  '真实性可疑',\r\n  '用户举报较多',\r\n  '举报较多',\r\n  '重复内容',\r\n];\r\n\r\nwindow.LATEST_POST_ID = parseInt(localStorage['_LATEST_POST_ID'], 10) || 0;\r\n\r\nconst DZ_NAME = '洞主';\r\n\r\nfunction load_single_meta(show_sidebar, token) {\r\n  return async (pid, replace = false) => {\r\n    let color_picker = new ColorPicker();\r\n    let title_elem = '树洞 #' + pid;\r\n    show_sidebar(\r\n      title_elem,\r\n      <div className=\"box box-tip\">正在加载 #{pid}</div>,\r\n      replace ? 'replace' : 'push',\r\n    );\r\n    try {\r\n      let single = await API.get_single(pid, token);\r\n      single.data.variant = {};\r\n      let { data: replies } = await API.load_replies_with_cache(\r\n        pid,\r\n        token,\r\n        color_picker,\r\n        parseInt(single.data.reply),\r\n      );\r\n      show_sidebar(\r\n        title_elem,\r\n        <FlowSidebar\r\n          key={+new Date()}\r\n          info={single.data}\r\n          replies={replies.data}\r\n          attention={replies.attention}\r\n          token={token}\r\n          show_sidebar={show_sidebar}\r\n          color_picker={color_picker}\r\n          deletion_detect={localStorage['DELETION_DETECT'] === 'on'}\r\n        />,\r\n        'replace',\r\n      );\r\n    } catch (e) {\r\n      console.error(e);\r\n      show_sidebar(\r\n        title_elem,\r\n        <div className=\"box box-tip\">\r\n          <p>\r\n            <a onClick={() => load_single_meta(show_sidebar, token)(pid, true)}>\r\n              重新加载\r\n            </a>\r\n          </p>\r\n          <p>{'' + e}</p>\r\n        </div>,\r\n        'replace',\r\n      );\r\n    }\r\n  };\r\n}\r\n\r\nclass Reply extends PureComponent {\r\n  constructor(props) {\r\n    super(props);\r\n  }\r\n\r\n  render() {\r\n    const replyContent = this.props.info.text;\r\n    const splitIdx = replyContent.indexOf(']');\r\n\r\n    const author = replyContent.substr(0, splitIdx + 1),\r\n      replyText = replyContent.substr(splitIdx + 2);\r\n    return (\r\n      <div\r\n        className={'flow-reply box'}\r\n        style={\r\n          this.props.info._display_color\r\n            ? {\r\n                '--box-bgcolor-light': this.props.info._display_color[0],\r\n                '--box-bgcolor-dark': this.props.info._display_color[1],\r\n              }\r\n            : null\r\n        }\r\n      >\r\n        <div className=\"box-header\">\r\n          <code className=\"box-id\">#{this.props.info.cid}</code>\r\n          {!!this.props.do_filter_name && (\r\n            <span\r\n              className=\"reply-header-badge clickable\"\r\n              onClick={() => {\r\n                this.props.do_filter_name(this.props.info.name);\r\n              }}\r\n            >\r\n              <span className=\"icon icon-locate\" />\r\n            </span>\r\n          )}\r\n          &nbsp;\r\n          {this.props.info.tag !== null && (\r\n            <span className=\"box-header-tag\">{this.props.info.tag}</span>\r\n          )}\r\n          <Time stamp={this.props.info.timestamp} short={false} />\r\n        </div>\r\n        <div className=\"box-content\">\r\n          <HighlightedMarkdown\r\n            author={author}\r\n            text={replyText}\r\n            color_picker={this.props.color_picker}\r\n            show_pid={this.props.show_pid}\r\n          />\r\n          {this.props.info.type === 'image' && (\r\n            <p className=\"img\">\r\n              {this.props.img_clickable ? (\r\n                <a\r\n                  className=\"no-underline\"\r\n                  href={IMAGE_BASE + this.props.info.url}\r\n                  target=\"_blank\"\r\n                >\r\n                  <img\r\n                    src={IMAGE_BASE + this.props.info.url}\r\n                    onError={(e) => {\r\n                      if (e.target.src === IMAGE_BASE + this.props.info.url) {\r\n                        e.target.src = IMAGE_BAK_BASE + this.props.info.url;\r\n                      }\r\n                    }}\r\n                    alt={IMAGE_BASE + this.props.info.url}\r\n                  />\r\n                </a>\r\n              ) : (\r\n                <img\r\n                  src={IMAGE_BASE + this.props.info.url}\r\n                  onError={(e) => {\r\n                    if (e.target.src === IMAGE_BASE + this.props.info.url) {\r\n                      e.target.src = IMAGE_BAK_BASE + this.props.info.url;\r\n                    }\r\n                  }}\r\n                  alt={IMAGE_BASE + this.props.info.url}\r\n                />\r\n              )}\r\n            </p>\r\n          )}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nclass FlowItem extends PureComponent {\r\n  constructor(props) {\r\n    super(props);\r\n  }\r\n\r\n  copy_link(event) {\r\n    event.preventDefault();\r\n    copy(\r\n      `${event.target.href}${\r\n        this.props.info.tag ? ' 【' + this.props.info.tag + '】' : ''\r\n      }\\n` +\r\n        `${this.props.info.text}${\r\n          this.props.info.type === 'image'\r\n            ? ' [图片]'\r\n            : this.props.info.type === 'audio'\r\n            ? ' [语音]'\r\n            : ''\r\n        }\\n` +\r\n        `（${format_time(new Date(this.props.info.timestamp * 1000))} ${\r\n          this.props.info.likenum\r\n        }关注 ${this.props.info.reply}回复）\\n` +\r\n        this.props.replies\r\n          .map((r) => (r.tag ? '【' + r.tag + '】' : '') + r.text)\r\n          .join('\\n'),\r\n    );\r\n  }\r\n\r\n  render() {\r\n    let props = this.props;\r\n    return (\r\n      <div className={'flow-item' + (props.is_quote ? ' flow-item-quote' : '')}>\r\n        {!!props.is_quote && (\r\n          <div className=\"quote-tip black-outline\">\r\n            <div>\r\n              <span className=\"icon icon-quote\" />\r\n            </div>\r\n            {/*<div>*/}\r\n            {/*  <small>提到</small>*/}\r\n            {/*</div>*/}\r\n          </div>\r\n        )}\r\n        <div className=\"box\">\r\n          {!!window.LATEST_POST_ID &&\r\n            parseInt(props.info.pid, 10) > window.LATEST_POST_ID && (\r\n              <div className=\"flow-item-dot\" />\r\n            )}\r\n          {!!this.props.attention && !this.props.cached && (\r\n            <div className=\"flow-item-dot\" />\r\n          )}\r\n          <div className=\"box-header\">\r\n            {!!this.props.do_filter_name && (\r\n              <span\r\n                className=\"reply-header-badge clickable\"\r\n                onClick={() => {\r\n                  this.props.do_filter_name(DZ_NAME);\r\n                }}\r\n              >\r\n                <span className=\"icon icon-locate\" />\r\n              </span>\r\n            )}\r\n            {!!parseInt(props.info.likenum, 10) && (\r\n              <span className=\"box-header-badge\">\r\n                {props.info.likenum}&nbsp;\r\n                <span\r\n                  className={\r\n                    'icon icon-' + (props.attention ? 'star-ok' : 'star')\r\n                  }\r\n                />\r\n              </span>\r\n            )}\r\n            {!!parseInt(props.info.reply, 10) && (\r\n              <span className=\"box-header-badge\">\r\n                {props.info.reply}&nbsp;\r\n                <span className=\"icon icon-reply\" />\r\n              </span>\r\n            )}\r\n            <code className=\"box-id\">\r\n              <a\r\n                href={'##' + props.info.pid}\r\n                onClick={this.copy_link.bind(this)}\r\n              >\r\n                #{props.info.pid}\r\n              </a>\r\n            </code>\r\n            &nbsp;\r\n            {props.info.tag !== null && props.info.tag !== '折叠' && (\r\n              <span className=\"box-header-tag\">{props.info.tag}</span>\r\n            )}\r\n            <Time stamp={props.info.timestamp} short={!props.img_clickable} />\r\n          </div>\r\n          <div className=\"box-content\">\r\n            <HighlightedMarkdown\r\n              text={props.info.text}\r\n              color_picker={props.color_picker}\r\n              show_pid={props.show_pid}\r\n            />\r\n            {props.info.type === 'image' && (\r\n              <p className=\"img\">\r\n                {props.img_clickable ? (\r\n                  <a\r\n                    className=\"no-underline\"\r\n                    href={IMAGE_BASE + props.info.url}\r\n                    target=\"_blank\"\r\n                  >\r\n                    <img\r\n                      src={IMAGE_BASE + props.info.url}\r\n                      onError={(e) => {\r\n                        if (e.target.src === IMAGE_BASE + props.info.url) {\r\n                          e.target.src = IMAGE_BAK_BASE + props.info.url;\r\n                        }\r\n                      }}\r\n                      alt={IMAGE_BASE + props.info.url}\r\n                    />\r\n                  </a>\r\n                ) : (\r\n                  <img\r\n                    src={IMAGE_BASE + props.info.url}\r\n                    onError={(e) => {\r\n                      if (e.target.src === IMAGE_BASE + props.info.url) {\r\n                        e.target.src = IMAGE_BAK_BASE + props.info.url;\r\n                      }\r\n                    }}\r\n                    alt={IMAGE_BASE + props.info.url}\r\n                  />\r\n                )}\r\n              </p>\r\n            )}\r\n            {/*{props.info.type==='audio' && <AudioWidget src={AUDIO_BASE+props.info.url} />}*/}\r\n          </div>\r\n          {!!(props.attention && props.info.variant.latest_reply) && (\r\n            <p className=\"box-footer\">\r\n              最新回复{' '}\r\n              <Time stamp={props.info.variant.latest_reply} short={false} />\r\n            </p>\r\n          )}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nclass FlowSidebar extends PureComponent {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      attention: props.attention,\r\n      info: props.info,\r\n      replies: props.replies,\r\n      loading_status: 'done',\r\n      error_msg: null,\r\n      filter_name: null,\r\n      rev: false,\r\n    };\r\n    this.color_picker = props.color_picker;\r\n    this.syncState = props.sync_state || (() => {});\r\n    this.reply_ref = React.createRef();\r\n  }\r\n\r\n  set_variant(cid, variant) {\r\n    this.setState(\r\n      (prev) => {\r\n        if (cid)\r\n          return {\r\n            replies: prev.replies.map((reply) => {\r\n              if (reply.cid === cid)\r\n                return Object.assign({}, reply, {\r\n                  variant: Object.assign({}, reply.variant, variant),\r\n                });\r\n              else return reply;\r\n            }),\r\n          };\r\n        else\r\n          return {\r\n            info: Object.assign({}, prev.info, {\r\n              variant: Object.assign({}, prev.info.variant, variant),\r\n            }),\r\n          };\r\n      },\r\n      function () {\r\n        this.syncState({\r\n          info: this.state.info,\r\n          replies: this.state.replies,\r\n        });\r\n      },\r\n    );\r\n  }\r\n\r\n  load_replies(update_count = true) {\r\n    this.setState({\r\n      loading_status: 'loading',\r\n      error_msg: null,\r\n    });\r\n    API.load_replies(\r\n      this.state.info.pid,\r\n      this.props.token,\r\n      this.color_picker,\r\n      null,\r\n    )\r\n      .then((json) => {\r\n        this.setState(\r\n          (prev, props) => ({\r\n            replies: json.data,\r\n            info: update_count\r\n              ? Object.assign({}, prev.info, {\r\n                  reply: '' + json.data.length,\r\n                })\r\n              : prev.info,\r\n            attention: !!json.attention,\r\n            loading_status: 'done',\r\n            error_msg: null,\r\n          }),\r\n          () => {\r\n            this.syncState({\r\n              replies: this.state.replies,\r\n              attention: this.state.attention,\r\n              info: this.state.info,\r\n            });\r\n            if (this.state.replies.length)\r\n              this.set_variant(null, {\r\n                latest_reply: Math.max.apply(\r\n                  null,\r\n                  this.state.replies.map((r) => parseInt(r.timestamp)),\r\n                ),\r\n              });\r\n          },\r\n        );\r\n      })\r\n      .catch((e) => {\r\n        console.error(e);\r\n        this.setState({\r\n          replies: [],\r\n          loading_status: 'done',\r\n          error_msg: '' + e,\r\n        });\r\n      });\r\n  }\r\n\r\n  toggle_attention() {\r\n    this.setState({\r\n      loading_status: 'loading',\r\n    });\r\n    const next_attention = !this.state.attention;\r\n    API.set_attention(this.state.info.pid, next_attention, this.props.token)\r\n      .then((json) => {\r\n        this.setState({\r\n          loading_status: 'done',\r\n          attention: next_attention,\r\n        });\r\n        this.syncState({\r\n          attention: next_attention,\r\n        });\r\n      })\r\n      .catch((e) => {\r\n        this.setState({\r\n          loading_status: 'done',\r\n        });\r\n        alert('设置关注失败');\r\n        console.error(e);\r\n      });\r\n  }\r\n\r\n  report() {\r\n    let reason = prompt(`举报 #${this.state.info.pid} 的理由：`);\r\n    if (reason !== null) {\r\n      API.report(this.state.info.pid, reason, this.props.token)\r\n        .then((json) => {\r\n          alert('举报成功');\r\n        })\r\n        .catch((e) => {\r\n          alert('举报失败');\r\n          console.error(e);\r\n        });\r\n    }\r\n  }\r\n\r\n  set_filter_name(name) {\r\n    this.setState((prevState) => ({\r\n      filter_name: name === prevState.filter_name ? null : name,\r\n    }));\r\n  }\r\n\r\n  toggle_rev() {\r\n    this.setState((prevState) => ({ rev: !prevState.rev }), forceCheck);\r\n  }\r\n\r\n  show_reply_bar(name, event) {\r\n    if (this.reply_ref.current && !event.target.closest('a, .clickable')) {\r\n      let text = this.reply_ref.current.get();\r\n      if (\r\n        /^\\s*(?:Re (?:|洞主|(?:[A-Z][a-z]+ )?(?:[A-Z][a-z]+)|You Win(?: \\d+)?):)?\\s*$/.test(\r\n          text,\r\n        )\r\n      ) {\r\n        // text is nearly empty so we can replace it\r\n        let should_text = 'Re ' + name + ': ';\r\n        if (should_text === this.reply_ref.current.get())\r\n          this.reply_ref.current.set('');\r\n        else this.reply_ref.current.set(should_text);\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    if (this.state.loading_status === 'loading')\r\n      return <p className=\"box box-tip\">加载中……</p>;\r\n\r\n    let show_pid = load_single_meta(this.props.show_sidebar, this.props.token);\r\n\r\n    let replies_to_show = this.state.filter_name\r\n      ? this.state.replies.filter((r) => r.name === this.state.filter_name)\r\n      : this.state.replies.slice();\r\n    if (this.state.rev) replies_to_show.reverse();\r\n\r\n    // may not need key, for performance\r\n    // key for lazyload elem\r\n    // let view_mode_key =\r\n    //   (this.state.rev ? 'y-' : 'n-') + (this.state.filter_name || 'null');\r\n\r\n    let replies_cnt = { [DZ_NAME]: 1 };\r\n    replies_to_show.forEach((r) => {\r\n      if (replies_cnt[r.name] === undefined) replies_cnt[r.name] = 0;\r\n      replies_cnt[r.name]++;\r\n    });\r\n\r\n    // hide main thread when filtered\r\n    let main_thread_elem =\r\n      this.state.filter_name && this.state.filter_name !== DZ_NAME ? null : (\r\n        <ClickHandler\r\n          callback={(e) => {\r\n            this.show_reply_bar('', e);\r\n          }}\r\n        >\r\n          <FlowItem\r\n            info={this.state.info}\r\n            attention={this.state.attention}\r\n            img_clickable={true}\r\n            color_picker={this.color_picker}\r\n            show_pid={show_pid}\r\n            replies={this.state.replies}\r\n            set_variant={(variant) => {\r\n              this.set_variant(null, variant);\r\n            }}\r\n            do_filter_name={\r\n              replies_cnt[DZ_NAME] > 1 ? this.set_filter_name.bind(this) : null\r\n            }\r\n          />\r\n        </ClickHandler>\r\n      );\r\n\r\n    return (\r\n      <div className=\"flow-item-row sidebar-flow-item\">\r\n        <div className=\"box box-tip\">\r\n          {!!this.props.token && (\r\n            <span>\r\n              <a onClick={this.report.bind(this)}>\r\n                <span className=\"icon icon-flag\" />\r\n                <label>举报</label>\r\n              </a>\r\n              &nbsp;&nbsp;\r\n            </span>\r\n          )}\r\n          <a onClick={this.load_replies.bind(this)}>\r\n            <span className=\"icon icon-refresh\" />\r\n            <label>刷新</label>\r\n          </a>\r\n          {(this.state.replies.length >= 1 || this.state.rev) && (\r\n            <span>\r\n              &nbsp;&nbsp;\r\n              <a onClick={this.toggle_rev.bind(this)}>\r\n                <span className=\"icon icon-order-rev\" />\r\n                <label>{this.state.rev ? '还原' : '逆序'}</label>\r\n              </a>\r\n            </span>\r\n          )}\r\n          {!!this.props.token && (\r\n            <span>\r\n              &nbsp;&nbsp;\r\n              <a\r\n                onClick={() => {\r\n                  this.toggle_attention();\r\n                }}\r\n              >\r\n                {this.state.attention ? (\r\n                  <span>\r\n                    <span className=\"icon icon-star-ok\" />\r\n                    <label>已关注</label>\r\n                  </span>\r\n                ) : (\r\n                  <span>\r\n                    <span className=\"icon icon-star\" />\r\n                    <label>未关注</label>\r\n                  </span>\r\n                )}\r\n              </a>\r\n            </span>\r\n          )}\r\n        </div>\r\n        {!!this.state.filter_name && (\r\n          <div className=\"box box-tip flow-item filter-name-bar\">\r\n            <p>\r\n              <span style={{ float: 'left' }}>\r\n                <a\r\n                  onClick={() => {\r\n                    this.set_filter_name(null);\r\n                  }}\r\n                >\r\n                  还原\r\n                </a>\r\n              </span>\r\n              <span className=\"icon icon-locate\" />\r\n              &nbsp;当前只看&nbsp;\r\n              <ColoredSpan\r\n                colors={this.color_picker.get(this.state.filter_name)}\r\n              >\r\n                {this.state.filter_name}\r\n              </ColoredSpan>\r\n            </p>\r\n          </div>\r\n        )}\r\n        {!this.state.rev && main_thread_elem}\r\n        {!!this.state.error_msg && (\r\n          <div className=\"box box-tip flow-item\">\r\n            <p>回复加载失败</p>\r\n            <p>{this.state.error_msg}</p>\r\n          </div>\r\n        )}\r\n        {this.props.deletion_detect &&\r\n          parseInt(this.state.info.reply) > this.state.replies.length &&\r\n          !!this.state.replies.length && (\r\n            <div className=\"box box-tip flow-item box-danger\">\r\n              {parseInt(this.state.info.reply) - this.state.replies.length}{' '}\r\n              条回复被删除\r\n            </div>\r\n          )}\r\n        {replies_to_show.map((reply, i) => (\r\n          <LazyLoad\r\n            key={i}\r\n            offset={1500}\r\n            height=\"5em\"\r\n            overflow={true}\r\n            once={true}\r\n          >\r\n            <ClickHandler\r\n              callback={(e) => {\r\n                this.show_reply_bar(reply.name, e);\r\n              }}\r\n            >\r\n              <Reply\r\n                info={reply}\r\n                color_picker={this.color_picker}\r\n                show_pid={show_pid}\r\n                set_variant={(variant) => {\r\n                  this.set_variant(reply.cid, variant);\r\n                }}\r\n                img_clickable={true}\r\n                do_filter_name={\r\n                  replies_cnt[reply.name] > 1\r\n                    ? this.set_filter_name.bind(this)\r\n                    : null\r\n                }\r\n              />\r\n            </ClickHandler>\r\n          </LazyLoad>\r\n        ))}\r\n        {this.state.rev && main_thread_elem}\r\n        {this.props.token ? (\r\n          <PostForm\r\n            pid={this.state.info.pid}\r\n            token={this.props.token}\r\n            action={'docomment'}\r\n            area_ref={this.reply_ref}\r\n            on_complete={this.load_replies.bind(this)}\r\n          />\r\n        ) : (\r\n          <div className=\"box box-tip flow-item\">登录后可以回复树洞</div>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nclass FlowItemRow extends PureComponent {\r\n  constructor(props) {\r\n    super(props);\r\n    this.needFold =\r\n      FOLD_TAGS.indexOf(props.info.tag) > -1 &&\r\n      (props.search_param === '热榜' || !props.search_param) &&\r\n      window.config.fold &&\r\n      props.mode !== 'attention' && props.mode !== 'attention_finished';\r\n    this.state = {\r\n      replies: [],\r\n      reply_status: 'done',\r\n      reply_error: null,\r\n      info: Object.assign({}, props.info, { variant: {} }),\r\n      hidden: window.config.block_words.some((word) =>\r\n        props.info.text.includes(word),\r\n      ) || this.needFold,\r\n      attention:\r\n        props.attention_override === null ? false : props.attention_override,\r\n      cached: true, // default no display anything\r\n    };\r\n    this.color_picker = new ColorPicker();\r\n  }\r\n\r\n  componentDidMount() {\r\n    if (parseInt(this.state.info.reply, 10)) {\r\n      this.load_replies(null, /*update_count=*/ false);\r\n    }\r\n  }\r\n\r\n  // reveal() {\r\n  //   this.setState({ hidden: false });\r\n  // }\r\n\r\n  load_replies(callback, update_count = true) {\r\n    console.log('fetching reply', this.state.info.pid);\r\n    this.setState({\r\n      reply_status: 'loading',\r\n      reply_error: null,\r\n    });\r\n    API.load_replies_with_cache(\r\n      this.state.info.pid,\r\n      this.props.token,\r\n      this.color_picker,\r\n      parseInt(this.state.info.reply),\r\n    )\r\n      .then(({ data: json, cached }) => {\r\n        this.setState(\r\n          (prev, props) => ({\r\n            replies: json.data,\r\n            info: Object.assign({}, prev.info, {\r\n              reply: update_count ? '' + json.data.length : prev.info.reply,\r\n              variant: json.data.length\r\n                ? {\r\n                    latest_reply: Math.max.apply(\r\n                      null,\r\n                      json.data.map((r) => parseInt(r.timestamp)),\r\n                    ),\r\n                  }\r\n                : {},\r\n            }),\r\n            attention: !!json.attention,\r\n            reply_status: 'done',\r\n            reply_error: null,\r\n            cached,\r\n          }),\r\n          callback,\r\n        );\r\n      })\r\n      .catch((e) => {\r\n        console.error(e);\r\n        this.setState(\r\n          {\r\n            replies: [],\r\n            reply_status: 'failed',\r\n            reply_error: '' + e,\r\n          },\r\n          callback,\r\n        );\r\n      });\r\n  }\r\n\r\n  show_sidebar() {\r\n    this.props.show_sidebar(\r\n      '树洞 #' + this.state.info.pid,\r\n      <FlowSidebar\r\n        key={+new Date()}\r\n        info={this.state.info}\r\n        replies={this.state.replies}\r\n        attention={this.state.attention}\r\n        sync_state={this.setState.bind(this)}\r\n        token={this.props.token}\r\n        show_sidebar={this.props.show_sidebar}\r\n        color_picker={this.color_picker}\r\n        deletion_detect={this.props.deletion_detect}\r\n      />,\r\n    );\r\n  }\r\n\r\n  render() {\r\n    let show_pid = load_single_meta(this.props.show_sidebar, this.props.token, [\r\n      this.state.info.pid,\r\n    ]);\r\n\r\n    let hl_rules = [\r\n      ['url_pid', URL_PID_RE],\r\n      ['url', URL_RE],\r\n      ['pid', PID_RE],\r\n      ['nickname', NICKNAME_RE],\r\n    ];\r\n    if (this.props.search_param) {\r\n      hl_rules.push([\r\n        'search',\r\n        !!this.props.search_param.match(/\\/.+\\//)\r\n          ? build_highlight_re(this.props.search_param, ' ', 'gi', true) // Use regex\r\n          : build_highlight_re(this.props.search_param, ' ', 'gi'), // Don't use regex\r\n      ]);\r\n    }\r\n    let parts = split_text(this.state.info.text, hl_rules);\r\n\r\n    let quote_id = null;\r\n    if (!this.props.is_quote)\r\n      for (let [mode, content] of parts) {\r\n        content = content.length > 0 ? content.substring(1) : content;\r\n        if (\r\n          mode === 'pid' &&\r\n          QUOTE_BLACKLIST.indexOf(content) === -1 &&\r\n          parseInt(content) < parseInt(this.state.info.pid)\r\n        )\r\n          if (quote_id === null) quote_id = parseInt(content);\r\n          else {\r\n            quote_id = null;\r\n            break;\r\n          }\r\n      }\r\n\r\n    let res = (\r\n      <div\r\n        className={\r\n          'flow-item-row flow-item-row-with-prompt' +\r\n          (this.props.is_quote ? ' flow-item-row-quote' : '')\r\n        }\r\n        onClick={(event) => {\r\n          if (!CLICKABLE_TAGS[event.target.tagName.toLowerCase()])\r\n            this.show_sidebar();\r\n        }}\r\n      >\r\n        <FlowItem\r\n          parts={parts}\r\n          info={this.state.info}\r\n          attention={this.state.attention}\r\n          img_clickable={false}\r\n          is_quote={this.props.is_quote}\r\n          color_picker={this.color_picker}\r\n          show_pid={show_pid}\r\n          replies={this.state.replies}\r\n          cached={this.state.cached}\r\n        />\r\n        <div className=\"flow-reply-row\">\r\n          {this.state.reply_status === 'loading' && (\r\n            <div className=\"box box-tip\">加载中</div>\r\n          )}\r\n          {this.state.reply_status === 'failed' && (\r\n            <div className=\"box box-tip\">\r\n              <p>\r\n                <a\r\n                  onClick={() => {\r\n                    this.load_replies();\r\n                  }}\r\n                >\r\n                  重新加载评论\r\n                </a>\r\n              </p>\r\n              <p>{this.state.reply_error}</p>\r\n            </div>\r\n          )}\r\n          {this.state.replies.slice(0, PREVIEW_REPLY_COUNT).map((reply) => (\r\n            <Reply\r\n              key={reply.cid}\r\n              info={reply}\r\n              img_clickable={false}\r\n              color_picker={this.color_picker}\r\n              show_pid={show_pid}\r\n            />\r\n          ))}\r\n          {this.state.replies.length > PREVIEW_REPLY_COUNT && (\r\n            <div className=\"box box-tip\">\r\n              还有 {this.state.replies.length - PREVIEW_REPLY_COUNT} 条\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    );\r\n\r\n    if (this.state.hidden) {\r\n      return (\r\n        <div\r\n          className=\"flow-item-row flow-item-row-with-prompt\"\r\n          onClick={(event) => {\r\n            if (!CLICKABLE_TAGS[event.target.tagName.toLowerCase()])\r\n              this.show_sidebar();\r\n          }}\r\n        >\r\n          <div\r\n            className={\r\n              'flow-item' + (this.props.is_quote ? ' flow-item-quote' : '')\r\n            }\r\n          >\r\n            {!!this.props.is_quote && (\r\n              <div className=\"quote-tip black-outline\">\r\n                <div>\r\n                  <span className=\"icon icon-quote\" />\r\n                </div>\r\n                {/*<div>*/}\r\n                {/*  <small>提到</small>*/}\r\n                {/*</div>*/}\r\n              </div>\r\n            )}\r\n            <div className=\"box\">\r\n              <div className=\"box-header\">\r\n                {!!this.props.do_filter_name && (\r\n                  <span\r\n                    className=\"reply-header-badge clickable\"\r\n                    onClick={() => {\r\n                      this.props.do_filter_name(DZ_NAME);\r\n                    }}\r\n                  >\r\n                    <span className=\"icon icon-locate\" />\r\n                  </span>\r\n                )}\r\n                <code className=\"box-id\">#{this.props.info.pid}</code>\r\n                &nbsp;\r\n                {this.props.info.tag !== null && this.props.info.tag !== '折叠' && (\r\n                  <span className=\"box-header-tag\">{this.props.info.tag}</span>\r\n                )}\r\n                <Time stamp={this.props.info.timestamp} short={true} />\r\n                <span className=\"box-header-badge\">{this.needFold ? '已隐藏' : '已屏蔽'}</span>\r\n                <div style={{ clear: 'both' }} />\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n\r\n    return quote_id ? (\r\n      <div>\r\n        {res}\r\n        <FlowItemQuote\r\n          pid={quote_id}\r\n          show_sidebar={this.props.show_sidebar}\r\n          token={this.props.token}\r\n          deletion_detect={this.props.deletion_detect}\r\n        />\r\n      </div>\r\n    ) : (\r\n      res\r\n    );\r\n  }\r\n}\r\n\r\nclass FlowItemQuote extends PureComponent {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      loading_status: 'empty',\r\n      error_msg: null,\r\n      info: null,\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.load();\r\n  }\r\n\r\n  load() {\r\n    this.setState(\r\n      {\r\n        loading_status: 'loading',\r\n      },\r\n      () => {\r\n        API.get_single(this.props.pid, this.props.token)\r\n          .then((json) => {\r\n            this.setState({\r\n              loading_status: 'done',\r\n              info: json.data,\r\n            });\r\n          })\r\n          .catch((err) => {\r\n            if (('' + err).indexOf('没有这条树洞') !== -1)\r\n              this.setState({\r\n                loading_status: 'empty',\r\n              });\r\n            else\r\n              this.setState({\r\n                loading_status: 'error',\r\n                error_msg: '' + err,\r\n              });\r\n          });\r\n      },\r\n    );\r\n  }\r\n\r\n  render() {\r\n    if (this.state.loading_status === 'empty') return null;\r\n    else if (this.state.loading_status === 'loading')\r\n      return (\r\n        <div className=\"aux-margin\">\r\n          <div className=\"box box-tip\">\r\n            <span className=\"icon icon-loading\" />\r\n            提到了 #{this.props.pid}\r\n          </div>\r\n        </div>\r\n      );\r\n    else if (this.state.loading_status === 'error')\r\n      return (\r\n        <div className=\"aux-margin\">\r\n          <div className=\"box box-tip\">\r\n            <p>\r\n              <a onClick={this.load.bind(this)}>重新加载</a>\r\n            </p>\r\n            <p>{this.state.error_msg}</p>\r\n          </div>\r\n        </div>\r\n      );\r\n    // 'done'\r\n    else\r\n      return (\r\n        <FlowItemRow\r\n          info={this.state.info}\r\n          mode={this.props.mode}\r\n          show_sidebar={this.props.show_sidebar}\r\n          token={this.props.token}\r\n          is_quote={true}\r\n          deletion_detect={this.props.deletion_detect}\r\n        />\r\n      );\r\n  }\r\n}\r\n\r\nfunction FlowChunk(props) {\r\n  return (\r\n    <TokenCtx.Consumer>\r\n      {({ value: token }) => (\r\n        <div className=\"flow-chunk\">\r\n          {!!props.title && <TitleLine text={props.title} />}\r\n          {props.list.map((info, ind) => (\r\n            <LazyLoad\r\n              key={info.pid}\r\n              offset={500}\r\n              height=\"15em\"\r\n              hiddenIfInvisible={false}\r\n            >\r\n              <div>\r\n                {!!(\r\n                  props.deletion_detect &&\r\n                  props.mode === 'list' &&\r\n                  ind &&\r\n                  props.list[ind - 1].pid - info.pid > 1\r\n                ) && (\r\n                  <div className=\"flow-item-row\">\r\n                    <div className=\"box box-tip flow-item box-danger\">\r\n                      {props.list[ind - 1].pid - info.pid - 1} 条被删除\r\n                    </div>\r\n                  </div>\r\n                )}\r\n                <FlowItemRow\r\n                  info={info}\r\n                  mode={props.mode}\r\n                  show_sidebar={props.show_sidebar}\r\n                  token={token}\r\n                  attention_override={\r\n                    props.mode === 'attention_finished' ? true : null\r\n                  }\r\n                  deletion_detect={props.deletion_detect}\r\n                  search_param={props.search_param}\r\n                />\r\n              </div>\r\n            </LazyLoad>\r\n          ))}\r\n        </div>\r\n      )}\r\n    </TokenCtx.Consumer>\r\n  );\r\n}\r\n\r\nexport class Flow extends PureComponent {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      mode: props.mode,\r\n      search_param: props.search_text,\r\n      loaded_pages: 0,\r\n      chunks: {\r\n        title: '',\r\n        data: [],\r\n      },\r\n      loading_status: 'done',\r\n      error_msg: null,\r\n    };\r\n    this.on_scroll_bound = this.on_scroll.bind(this);\r\n    window.LATEST_POST_ID = parseInt(localStorage['_LATEST_POST_ID'], 10) || 0;\r\n  }\r\n\r\n  load_page(page) {\r\n    const failed = (err) => {\r\n      console.error(err);\r\n      this.setState((prev, props) => ({\r\n        loaded_pages: prev.loaded_pages - 1,\r\n        loading_status: 'failed',\r\n        error_msg: '' + err,\r\n      }));\r\n    };\r\n\r\n    if (page > this.state.loaded_pages + 1) throw new Error('bad page');\r\n    if (page === this.state.loaded_pages + 1) {\r\n      console.log('fetching page', page);\r\n      if (this.state.mode === 'list') {\r\n        API.get_list(page, this.props.token)\r\n          .then((json) => {\r\n            if (page === 1 && json.data.length) {\r\n              // update latest_post_id\r\n              let max_id = -1;\r\n              json.data.forEach((x) => {\r\n                if (parseInt(x.pid, 10) > max_id) max_id = parseInt(x.pid, 10);\r\n              });\r\n              localStorage['_LATEST_POST_ID'] = '' + max_id;\r\n            }\r\n            this.setState((prev, props) => ({\r\n              chunks: {\r\n                title: 'News Feed',\r\n                data: prev.chunks.data.concat(\r\n                  json.data.filter(\r\n                    (x) =>\r\n                      prev.chunks.data.length === 0 ||\r\n                      !prev.chunks.data\r\n                        .slice(-100)\r\n                        .some((p) => p.pid === x.pid),\r\n                  ),\r\n                ),\r\n              },\r\n              loading_status: 'done',\r\n            }));\r\n          })\r\n          .catch(failed);\r\n      } else if (this.state.mode === 'search') {\r\n        API.get_search(page, this.state.search_param, this.props.token)\r\n          .then((json) => {\r\n            const finished = json.data.length === 0;\r\n            this.setState((prev, props) => ({\r\n              chunks: {\r\n                title: 'Result for \"' + this.state.search_param + '\"',\r\n                data: prev.chunks.data.concat(\r\n                  json.data.filter(\r\n                    (x) =>\r\n                      prev.chunks.data.length === 0 ||\r\n                      !prev.chunks.data\r\n                        .slice(-100)\r\n                        .some((p) => p.pid === x.pid),\r\n                  ),\r\n                ),\r\n              },\r\n              mode: finished ? 'search_finished' : 'search',\r\n              loading_status: 'done',\r\n            }));\r\n          })\r\n          .catch(failed);\r\n      } else if (this.state.mode === 'single') {\r\n        const pid = parseInt(this.state.search_param.substr(1), 10);\r\n        API.get_single(pid, this.props.token)\r\n          .then((json) => {\r\n            this.setState({\r\n              chunks: {\r\n                title: 'PID = ' + pid,\r\n                data: [json.data],\r\n              },\r\n              mode: 'single_finished',\r\n              loading_status: 'done',\r\n            });\r\n          })\r\n          .catch(failed);\r\n      } else if (this.state.mode === 'attention') {\r\n        let use_search = !!this.state.search_param;\r\n        let use_regex = use_search && !!this.state.search_param.match(/\\/.+\\//);\r\n        let regex_search = /.+/;\r\n        if (use_regex) {\r\n          try {\r\n            regex_search = new RegExp(this.state.search_param.slice(1, -1));\r\n          } catch (e) {\r\n            alert(`请检查正则表达式合法性！\\n${e}`);\r\n            regex_search = /.+/;\r\n          }\r\n        }\r\n        console.log(use_search, use_regex);\r\n        API.get_attention(this.props.token)\r\n          .then((json) => {\r\n            this.setState({\r\n              chunks: {\r\n                title: `${\r\n                  use_search\r\n                    ? use_regex\r\n                      ? `Result for RegEx ${regex_search.toString()} in `\r\n                      : `Result for \"${this.state.search_param}\" in `\r\n                    : ''\r\n                }Attention List`,\r\n                data: !use_search\r\n                  ? json.data\r\n                  : !use_regex\r\n                  ? json.data.filter((post) => {\r\n                      return this.state.search_param\r\n                        .split(' ')\r\n                        .every((keyword) => post.text.includes(keyword));\r\n                    }) // Not using regex\r\n                  : json.data.filter((post) => !!post.text.match(regex_search)), // Using regex\r\n              },\r\n              mode: 'attention_finished',\r\n              loading_status: 'done',\r\n            });\r\n          })\r\n          .catch(failed);\r\n      } else {\r\n        console.log('nothing to load');\r\n        return;\r\n      }\r\n\r\n      this.setState((prev, props) => ({\r\n        loaded_pages: prev.loaded_pages + 1,\r\n        loading_status: 'loading',\r\n        error_msg: null,\r\n      }));\r\n    }\r\n  }\r\n\r\n  on_scroll(event) {\r\n    if (event.target === document) {\r\n      const avail =\r\n        document.body.scrollHeight - window.scrollY - window.innerHeight;\r\n      if (avail < window.innerHeight && this.state.loading_status === 'done')\r\n        this.load_page(this.state.loaded_pages + 1);\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.load_page(1);\r\n    window.addEventListener('scroll', this.on_scroll_bound);\r\n    window.addEventListener('resize', this.on_scroll_bound);\r\n  }\r\n  componentWillUnmount() {\r\n    window.removeEventListener('scroll', this.on_scroll_bound);\r\n    window.removeEventListener('resize', this.on_scroll_bound);\r\n  }\r\n\r\n  render() {\r\n    const should_deletion_detect = localStorage['DELETION_DETECT'] === 'on';\r\n    return (\r\n      <div className=\"flow-container\">\r\n        <FlowChunk\r\n          title={this.state.chunks.title}\r\n          list={this.state.chunks.data}\r\n          mode={this.state.mode}\r\n          search_param={this.state.search_param || null}\r\n          show_sidebar={this.props.show_sidebar}\r\n          deletion_detect={should_deletion_detect}\r\n        />\r\n        {this.state.loading_status === 'failed' && (\r\n          <div className=\"aux-margin\">\r\n            <div className=\"box box-tip\">\r\n              <p>\r\n                <a\r\n                  onClick={() => {\r\n                    this.load_page(this.state.loaded_pages + 1);\r\n                  }}\r\n                >\r\n                  重新加载\r\n                </a>\r\n              </p>\r\n              <p>{this.state.error_msg}</p>\r\n            </div>\r\n          </div>\r\n        )}\r\n        <TitleLine\r\n          text={\r\n            this.state.loading_status === 'loading' ? (\r\n              <span>\r\n                <span className=\"icon icon-loading\" />\r\n                &nbsp;Loading...\r\n              </span>\r\n            ) : (\r\n              '© thuhole'\r\n            )\r\n          }\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import React, { PureComponent } from 'react';\r\n// import {AppSwitcher} from './infrastructure/widgets';\r\nimport { InfoSidebar, PostForm } from './UserAction';\r\nimport { TokenCtx } from './UserAction';\r\n\r\nimport './Title.css';\r\n\r\nconst flag_re = /^\\/\\/setflag ([a-zA-Z0-9_]+)=(.*)$/;\r\n\r\nclass ControlBar extends PureComponent {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      search_text: '',\r\n    };\r\n    this.set_mode = props.set_mode;\r\n\r\n    this.on_change_bound = this.on_change.bind(this);\r\n    this.on_keypress_bound = this.on_keypress.bind(this);\r\n    this.do_refresh_bound = this.do_refresh.bind(this);\r\n    this.do_attention_bound = this.do_attention.bind(this);\r\n  }\r\n\r\n  componentDidMount() {\r\n    if (window.location.hash) {\r\n      let text = decodeURIComponent(window.location.hash).substr(1);\r\n      if (text.lastIndexOf('?') !== -1)\r\n        text = text.substr(0, text.lastIndexOf('?')); // fuck wechat '#param?nsukey=...'\r\n      this.setState(\r\n        {\r\n          search_text: text,\r\n        },\r\n        () => {\r\n          this.on_keypress({ key: 'Enter' });\r\n        },\r\n      );\r\n    }\r\n  }\r\n\r\n  on_change(event) {\r\n    this.setState({\r\n      search_text: event.target.value,\r\n    });\r\n  }\r\n\r\n  on_keypress(event) {\r\n    if (event.key === 'Enter') {\r\n      let flag_res = flag_re.exec(this.state.search_text);\r\n      if (flag_res) {\r\n        if (flag_res[2]) {\r\n          localStorage[flag_res[1]] = flag_res[2];\r\n          alert(\r\n            'Set Flag ' +\r\n              flag_res[1] +\r\n              '=' +\r\n              flag_res[2] +\r\n              '\\nYou may need to refresh this webpage.',\r\n          );\r\n        } else {\r\n          delete localStorage[flag_res[1]];\r\n          alert(\r\n            'Clear Flag ' +\r\n              flag_res[1] +\r\n              '\\nYou may need to refresh this webpage.',\r\n          );\r\n        }\r\n        return;\r\n      }\r\n\r\n      const mode = this.state.search_text.startsWith('#')\r\n        ? 'single'\r\n        : this.props.mode !== 'attention'\r\n        ? 'search'\r\n        : 'attention';\r\n      this.set_mode(mode, this.state.search_text || '');\r\n    }\r\n  }\r\n\r\n  do_refresh() {\r\n    window.scrollTo(0, 0);\r\n    this.setState({\r\n      search_text: '',\r\n    });\r\n    this.set_mode('list', null);\r\n  }\r\n\r\n  do_attention() {\r\n    window.scrollTo(0, 0);\r\n    this.setState({\r\n      search_text: '',\r\n    });\r\n    this.set_mode('attention', null);\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <TokenCtx.Consumer>\r\n        {({ value: token }) => (\r\n          <div className=\"control-bar\">\r\n            <a\r\n              className=\"no-underline control-btn\"\r\n              onClick={this.do_refresh_bound}\r\n            >\r\n              <span className=\"icon icon-refresh\" />\r\n              <span className=\"control-btn-label\">最新</span>\r\n            </a>\r\n            {!!token && (\r\n              <a\r\n                className=\"no-underline control-btn\"\r\n                onClick={this.do_attention_bound}\r\n              >\r\n                <span className=\"icon icon-attention\" />\r\n                <span className=\"control-btn-label\">关注</span>\r\n              </a>\r\n            )}\r\n            <input\r\n              className=\"control-search\"\r\n              value={this.state.search_text}\r\n              placeholder={`${\r\n                this.props.mode === 'attention' ? '在关注列表中' : ''\r\n              }搜索 或 #树洞号`}\r\n              onChange={this.on_change_bound}\r\n              onKeyPress={this.on_keypress_bound}\r\n            />\r\n            <a\r\n              className=\"no-underline control-btn\"\r\n              onClick={() => {\r\n                this.props.show_sidebar(\r\n                  'T大树洞',\r\n                  <InfoSidebar show_sidebar={this.props.show_sidebar} />,\r\n                );\r\n              }}\r\n            >\r\n              <span className={'icon icon-' + (token ? 'about' : 'login')} />\r\n              <span className=\"control-btn-label\">\r\n                {token ? '账户' : '登录'}\r\n              </span>\r\n            </a>\r\n            {!!token && (\r\n              <a\r\n                className=\"no-underline control-btn\"\r\n                onClick={() => {\r\n                  this.props.show_sidebar(\r\n                    '发表树洞',\r\n                    <PostForm\r\n                      token={token}\r\n                      action={'dopost'}\r\n                      pid={'new_post'}\r\n                      on_complete={() => {\r\n                        this.props.show_sidebar(null, null, 'clear');\r\n                        this.do_refresh();\r\n                      }}\r\n                    />,\r\n                  );\r\n                }}\r\n              >\r\n                <span className=\"icon icon-plus\" />\r\n                <span className=\"control-btn-label\">发表</span>\r\n              </a>\r\n            )}\r\n          </div>\r\n        )}\r\n      </TokenCtx.Consumer>\r\n    );\r\n  }\r\n}\r\n\r\nexport function Title(props) {\r\n  return (\r\n    <div className=\"title-bar\">\r\n      {/* <AppSwitcher appid=\"hole\" /> */}\r\n      <div className=\"aux-margin\">\r\n        <div className=\"title\">\r\n          <p className=\"centered-line\">\r\n            <span\r\n              onClick={() =>\r\n                props.show_sidebar(\r\n                  'T大树洞',\r\n                  <InfoSidebar show_sidebar={props.show_sidebar} />,\r\n                )\r\n              }\r\n            >\r\n              T大树洞\r\n            </span>\r\n          </p>\r\n        </div>\r\n        <ControlBar\r\n          show_sidebar={props.show_sidebar}\r\n          set_mode={props.set_mode}\r\n          mode={props.mode}\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","import React, { PureComponent } from 'react';\r\nimport './Sidebar.css';\r\n\r\nexport class Sidebar extends PureComponent {\r\n  constructor(props) {\r\n    super(props);\r\n    // this.sidebar_ref = React.createRef();\r\n    this.do_close_bound = this.do_close.bind(this);\r\n    this.do_back_bound = this.do_back.bind(this);\r\n  }\r\n\r\n  do_close() {\r\n    this.props.show_sidebar(null, null, 'clear');\r\n  }\r\n  do_back() {\r\n    this.props.show_sidebar(null, null, 'pop');\r\n  }\r\n\r\n  render() {\r\n    // hide old contents to remember state\r\n    let contents = this.props.stack.map(\r\n      ({ 1: content }, i) =>\r\n        content && (\r\n          <div\r\n            key={i}\r\n            className={\r\n              'sidebar-content ' +\r\n              (i === this.props.stack.length - 1\r\n                ? 'sidebar-content-show'\r\n                : 'sidebar-content-hide')\r\n            }\r\n          >\r\n            {content}\r\n          </div>\r\n        ),\r\n    );\r\n    let cur_title = this.props.stack[this.props.stack.length - 1][0];\r\n    return (\r\n      <div\r\n        className={\r\n          'sidebar-container ' +\r\n          (cur_title !== null ? 'sidebar-on' : 'sidebar-off')\r\n        }\r\n      >\r\n        <div\r\n          className=\"sidebar-shadow\"\r\n          onClick={this.do_back_bound}\r\n          onTouchEnd={(e) => {\r\n            e.preventDefault();\r\n            e.target.click();\r\n          }}\r\n        />\r\n        <div className=\"sidebar\">{contents}</div>\r\n        <div className=\"sidebar-title\">\r\n          <a className=\"no-underline\" onClick={this.do_close_bound}>\r\n            &nbsp;\r\n            <span className=\"icon icon-close\" />\r\n            &nbsp;\r\n          </a>\r\n          {this.props.stack.length > 2 && (\r\n            <a className=\"no-underline\" onClick={this.do_back_bound}>\r\n              &nbsp;\r\n              <span className=\"icon icon-back\" />\r\n              &nbsp;\r\n            </a>\r\n          )}\r\n          {cur_title}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import React, { Component } from 'react';\r\nimport Pressure from 'pressure';\r\n\r\nimport './PressureHelper.css';\r\n\r\nconst THRESHOLD = 0.4;\r\nconst MULTIPLIER = 25;\r\nconst BORDER_WIDTH = 500; // also change css!\r\n\r\nexport class PressureHelper extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      level: 0,\r\n      fired: false,\r\n    };\r\n    this.callback = props.callback;\r\n    this.esc_interval = null;\r\n  }\r\n\r\n  do_fire() {\r\n    if (this.esc_interval) {\r\n      clearInterval(this.esc_interval);\r\n      this.esc_interval = null;\r\n    }\r\n    this.setState({\r\n      level: 1,\r\n      fired: true,\r\n    });\r\n    this.callback();\r\n    window.setTimeout(() => {\r\n      this.setState({\r\n        level: 0,\r\n        fired: false,\r\n      });\r\n    }, 300);\r\n  }\r\n\r\n  componentDidMount() {\r\n    if (window.config.pressure) {\r\n      Pressure.set(\r\n        document.body,\r\n        {\r\n          change: (force) => {\r\n            if (!this.state.fired) {\r\n              if (force >= 0.999) {\r\n                this.do_fire();\r\n              } else\r\n                this.setState({\r\n                  level: force,\r\n                });\r\n            }\r\n          },\r\n          end: () => {\r\n            this.setState({\r\n              level: 0,\r\n              fired: false,\r\n            });\r\n          },\r\n        },\r\n        {\r\n          polyfill: false,\r\n          only: 'touch',\r\n          preventSelect: false,\r\n        },\r\n      );\r\n\r\n      document.addEventListener('keydown', (e) => {\r\n        if (!e.repeat && e.key === 'Escape') {\r\n          if (this.esc_interval) clearInterval(this.esc_interval);\r\n          this.setState(\r\n            {\r\n              level: THRESHOLD / 2,\r\n            },\r\n            () => {\r\n              this.esc_interval = setInterval(() => {\r\n                let new_level = this.state.level + 0.1;\r\n                if (new_level >= 0.999) this.do_fire();\r\n                else\r\n                  this.setState({\r\n                    level: new_level,\r\n                  });\r\n              }, 30);\r\n            },\r\n          );\r\n        }\r\n      });\r\n      document.addEventListener('keyup', (e) => {\r\n        if (e.key === 'Escape') {\r\n          if (this.esc_interval) {\r\n            clearInterval(this.esc_interval);\r\n            this.esc_interval = null;\r\n          }\r\n          this.setState({\r\n            level: 0,\r\n          });\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const pad = MULTIPLIER * (this.state.level - THRESHOLD) - BORDER_WIDTH;\r\n    return (\r\n      <div\r\n        className={\r\n          'pressure-box' +\r\n          (this.state.fired ? ' pressure-box-fired' : '') +\r\n          (this.state.level <= 0.0001 ? ' pressure-box-empty' : '')\r\n        }\r\n        style={{\r\n          left: pad,\r\n          right: pad,\r\n          top: pad,\r\n          bottom: pad,\r\n        }}\r\n      />\r\n    );\r\n  }\r\n}\r\n","import React, { Component } from 'react';\r\nimport { Flow } from './Flows';\r\nimport { Title } from './Title';\r\nimport { Sidebar } from './Sidebar';\r\nimport { PressureHelper } from './PressureHelper';\r\nimport { TokenCtx } from './UserAction';\r\nimport { load_config, bgimg_style } from './Config';\r\nimport { listen_darkmode } from './infrastructure/functions';\r\nimport { LoginPopup, TitleLine } from './infrastructure/widgets';\r\nimport { cache } from './cache';\r\n\r\nconst MAX_SIDEBAR_STACK_SIZE = 10;\r\n\r\nfunction DeprecatedAlert(props) {\r\n  return <div id=\"global-hint-container\" style={{ display: 'none' }} />;\r\n}\r\n\r\nclass App extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    load_config();\r\n    listen_darkmode(\r\n      { default: undefined, light: false, dark: true }[\r\n        window.config.color_scheme\r\n      ],\r\n    );\r\n    this.state = {\r\n      sidebar_stack: [[null, null]], // list of [status, content]\r\n      mode: 'list', // list, single, search, attention\r\n      search_text: null,\r\n      flow_render_key: +new Date(),\r\n      token: localStorage['TOKEN'] || null,\r\n    };\r\n    this.show_sidebar_bound = this.show_sidebar.bind(this);\r\n    this.set_mode_bound = this.set_mode.bind(this);\r\n    this.on_pressure_bound = this.on_pressure.bind(this);\r\n    // a silly self-deceptive approach to ban guests, enough to fool those muggles\r\n    //                     document             cookie                    'pku_ip_flag=yes'\r\n    this.inthu_flag =\r\n      window[atob('ZG9jdW1lbnQ')][atob('Y29va2ll')].indexOf(\r\n        atob('dGh1X2lwX2ZsYWc9eWVz'),\r\n      ) !== -1;\r\n  }\r\n\r\n  static is_darkmode() {\r\n    if (window.config.color_scheme === 'dark') return true;\r\n    if (window.config.color_scheme === 'light') return false;\r\n    else {\r\n      // 'default'\r\n      return window.matchMedia('(prefers-color-scheme: dark)').matches;\r\n    }\r\n  }\r\n    componentDidMount() {\r\n        cache(); // init indexeddb\r\n    }\r\n\r\n  on_pressure() {\r\n    if (this.state.sidebar_stack.length > 1)\r\n      this.show_sidebar(null, null, 'clear');\r\n    else this.set_mode('list', null);\r\n  }\r\n\r\n  show_sidebar(title, content, mode = 'push') {\r\n    this.setState((prevState) => {\r\n      let ns = prevState.sidebar_stack.slice();\r\n      if (mode === 'push') {\r\n        if (ns.length === 1) {\r\n          document.body.style.top = `-${window.scrollY}px`;\r\n          document.body.style.position = 'fixed';\r\n          document.body.style.width = '100vw'; // Be responsive with fixed position\r\n        }\r\n        if (ns.length > MAX_SIDEBAR_STACK_SIZE) ns.splice(1, 1);\r\n        ns = ns.concat([[title, content]]);\r\n      } else if (mode === 'pop') {\r\n        if (ns.length === 1) return;\r\n        if (ns.length === 2) {\r\n          const scrollY = document.body.style.top;\r\n          document.body.style.position = '';\r\n          document.body.style.top = '';\r\n          document.body.style.width = '';\r\n          window.scrollTo(0, parseInt(scrollY || '0') * -1);\r\n        }\r\n        ns.pop();\r\n      } else if (mode === 'replace') {\r\n        ns.pop();\r\n        ns = ns.concat([[title, content]]);\r\n      } else if (mode === 'clear') {\r\n        const scrollY = document.body.style.top;\r\n        document.body.style.position = '';\r\n        document.body.style.top = '';\r\n        document.body.style.width = '';\r\n        window.scrollTo(0, parseInt(scrollY || '0') * -1);\r\n        ns = [[null, null]];\r\n      } else throw new Error('bad show_sidebar mode');\r\n      return {\r\n        sidebar_stack: ns,\r\n      };\r\n    });\r\n  }\r\n\r\n  set_mode(mode, search_text) {\r\n    this.setState({\r\n      mode: mode,\r\n      search_text: search_text,\r\n      flow_render_key: +new Date(),\r\n    });\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <TokenCtx.Provider\r\n        value={{\r\n          value: this.state.token,\r\n          set_value: (x) => {\r\n            localStorage['TOKEN'] = x || '';\r\n            this.setState({\r\n              token: x,\r\n            });\r\n          },\r\n        }}\r\n      >\r\n        <PressureHelper callback={this.on_pressure_bound} />\r\n        <div className=\"bg-img\" style={bgimg_style()} />\r\n        <Title\r\n          show_sidebar={this.show_sidebar_bound}\r\n          set_mode={this.set_mode_bound}\r\n          mode={this.state.mode}\r\n        />\r\n        <TokenCtx.Consumer>\r\n          {(token) => (\r\n            <div className=\"left-container\">\r\n              <DeprecatedAlert token={token.value} />\r\n              {!token.value && (\r\n                <div className=\"flow-item-row aux-margin\">\r\n                  <div className=\"box box-tip\">\r\n                    <p>\r\n                      <LoginPopup token_callback={token.set_value}>\r\n                        {(do_popup) => (\r\n                          <a onClick={do_popup}>\r\n                            <span className=\"icon icon-login\" />\r\n                            &nbsp;登录到 T大树洞\r\n                          </a>\r\n                        )}\r\n                      </LoginPopup>\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n              )}\r\n              {this.inthu_flag || token.value ? (\r\n                <Flow\r\n                  key={this.state.flow_render_key}\r\n                  show_sidebar={this.show_sidebar_bound}\r\n                  mode={this.state.mode}\r\n                  search_text={this.state.search_text}\r\n                  token={token.value}\r\n                />\r\n              ) : (\r\n                <TitleLine text=\"请登录后查看内容\" />\r\n              )}\r\n              <br />\r\n            </div>\r\n          )}\r\n        </TokenCtx.Consumer>\r\n        <Sidebar\r\n          show_sidebar={this.show_sidebar_bound}\r\n          stack={this.state.sidebar_stack}\r\n        />\r\n      </TokenCtx.Provider>\r\n    );\r\n  }\r\n}\r\n\r\nexport default App;\r\n","// In production, we register a service worker to serve assets from local cache.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\r\n// cached resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\r\n// This link also includes instructions on opting out of this behavior.\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.1/8 is considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/,\r\n    ),\r\n);\r\n\r\nexport default function register() {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    // const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\r\n    // if (publicUrl.origin !== window.location.origin) {\r\n    // Our service worker won't work if PUBLIC_URL is on a different origin\r\n    // from what our page is served on. This might happen if a CDN is used to\r\n    // serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374\r\n    // return;\r\n    // }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Lets check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://goo.gl/SC7cgQ',\r\n          );\r\n        });\r\n      } else {\r\n        // Is not local host. Just register service worker\r\n        registerValidSW(swUrl);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then((registration) => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the old content will have been purged and\r\n              // the fresh content will have been added to the cache.\r\n              // It's the perfect time to display a \"New content is\r\n              // available; please refresh.\" message in your web app.\r\n              console.log('New content is available; please refresh.');\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch((error) => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl)\r\n    .then((response) => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      if (\r\n        response.status === 404 ||\r\n        response.headers.get('content-type').indexOf('javascript') === -1\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then((registration) => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.',\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready.then((registration) => {\r\n      registration.unregister();\r\n    });\r\n  }\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\n//import {elevate} from './infrastructure/elevator';\r\nimport registerServiceWorker from './registerServiceWorker';\r\n\r\n//elevate();\r\n\r\nReactDOM.render(<App />, document.getElementById('root'));\r\nregisterServiceWorker();\r\n","module.exports = \"data:image/png;base64,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\"","module.exports = \"data:image/png;base64,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\"","module.exports = \"data:image/png;base64,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\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAAFdklEQVR42sVW+VNTVxS+f4Od9oeW0RmlU8dOcRx3BEHbqiio3dtfamds+0N1bGe62emirYpSLRYDguAWJQihLZBAEkgKgbCHgIBAXbBTtgSykhAQEL/ecyWtwwMHx9DemS/vvXvv+c73zj3n5DEAjHBodJz9MD7BvuP3KVbb0xqV1p6lzENzS9u7Y3zOVWNittXPMmvMWmaNjZgeW8OZY91i1pSbzSqcg6y01Lj7V7UOap3Bma9WhyiKtEyh0bGsQg0L+P3n5talDNZ5LpWZCwqYqqYxJk9TggK1Bkpza7pWrWNdsZHM/uKymZ1Pgvb07ohiel0Jy7VcO1ug0iCfc+WbW7fUa0vYrUw5u6G8IhXglR1l/qR45tu/l9WeTo5XGqvxS3k1tPmF+t6Y8MXOVYui+3ZEb+ROHoq+HVEb3WtCo23bIhZrCwoNuZyHuKpTU474v/2M+dOSmDdDJhVgzUxn1oQDcd7w59C5+00oqxqgsLTBnHAIQ8vnoy9uPbiDWYH2kk1dwmFkWdqRU2nG9V2vw8e5rScOx/ZnX5YK6Dvw6Z6+VzYMepY8hT8++ZALMONKfQuqkxLhWf88rNvCZy2A54KwqTp1UnCQgPZ9H8Cz5ElYX93gsR38/COpgO3r5bata+FYHYrKve8jp7EDuW23USRLQveKhXDERc5agCMuAt0rF6JQdkpw5DS1o3LPbsFti1nLIxQplx7BljVyO3fSExUG/YYVyFMVIa/lOvLfewcdyxbAvTNq1gJobzu3Ue16G3nNnCNfDUP0cvRELwX5IF9SAbERchtftO+MRsOKUKjXhUG9JRJlSxegm4fUvn32OUB7ycYYNh/qzRFQh4cJTuK23Y+kVED/1nA5BxycwMZxbWUoml4IQdemVXBujwStPQpc3KZr8yo0hYWglXMRJ3FPrksF2F57Sc4BK4f9jZfhfmuzgPPNTWLO9oggG7IN8BDnAzxSAaWL5sk58C+emMS8x8S0PFIBjQf3yznwH0EqwAfIOTAThqZgpjXf7CAV4PAMyjkwFXa3R1xHx+9i4h4wzn/o6r8zKtb6XW4MjdwBnxLw+ofF3HRcD2D2AlxeH5yDXpgsjdBWmFBcVY3S2jr0DTiEKN/wCFpu3ERReQUM1TW4+VcXfFxQ0AQMDvmFiPQcJb5PTkHi+Qs4cEqGo2fS0dndCxrFlVX4OvEkvvjxOCrMDSISQRMQgM3pgtXhFPd0lV3OxOmsKyICdByd3T04xkVVNFhw994cCPDwSIyMjQtyGhVms4hIt61fPA/wcz+WnjF3Alw8DygKvXYHbvf0IlmhgDy/QCQdCeviQuZUAL04kX/1UyK++TkJB2XJ+JMLIWd0DHMugEqNMrysrh6GmlocP3ceOlMlhkfHRA7MuYCByXoPDD0vucOnU2HlR0IOe/oHRBJSuU4EswoCjYjelOqeGhENpVaHhIyzounQcPNSjU87g/qWVvF83zYIAty+IdGI1GVGXCpQ4Te9ARnKXHx5/AQqLU3CWUNbu5g7kpomypOaFdmQ7WMLoPKjClCo1Dh54SJSMhVIy85BbXMLRnhUKNzUGU+cPYdsjRYpiixc4tVBzcsz9AgCXF7vQ3OAOiJlO139PBfG7k4IJ5Qb9Ka0RiUZ2PPQkua+JAKcfJIvzGhEZxwAOZ7aIzwPrLunrE/z3zLN90Brh9zu8vCmMsY3DIozDCYcHJTIlNTNHdelAorLTPG1lmbYuUrfCA/nsB+D/uDA679/fBSBWstVaPTGIxIBXX22EH151UVdqQn1V1sF6ppagoIAX6mpBhpD+YUSY9Uz0s/ygQFWXtPA1MXGjzUGo4Fv1HCoggRNkcGoLykz7fvdVMP0HBIB/xf+Bi8VajXQRja5AAAAAElFTkSuQmCC\"","module.exports = \"data:image/png;base64,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\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAC4jAAAuIwF4pT92AAAHvElEQVR42o1Xa3MTVRgOzDgKjl9U1PFfqDgy47/QEZzRn6D4AQWkNJcWCm2apGku2yQUKAoI1iKglPullIvITZFbC4zKTWpLu7vZTZvs7vF537ObbEIZycyZ3dmc816e93kvJxAOhwOzrVAoFGgJh+dgPfdlc3Pg89VNgfWRSGCwI/re7WS6bSqTO65ncqNYI3g/cieZbt3T3rGwLRzhvXSGzpIMkvU0PbMqpmcEB5tCwcDKYDCQW7P2zbOxxFf3U9lhNZMb1zK5MpaN5biL3ssw5N/73dkh7F2GM2/QWZJBskI+2U81wLdh7opgc6CrtfWly/Fkq5HNj1eUgjCzeaE/ZWnuk/bQXpwZw9kQZLxIsmDE3PAsRjyhHM+5ZPnA+vb3Ae+NcrYg4J2A5xU8LfJYdz2HQl7Vd6VgwxDL3SvobDGTu9q/rn3RCoQkDNmNRjQiMHc5Nh6Nxj61lUKl6Cpm4Xj3Ka15ju/8TGaElkg5WkqR/ysFR83mWYalFMpHorElJDvkGlFnAFsUkrBj4yc4QIodTclbnjDX03roq8qzwti9V5j79gu9sFFoXWlHi3U7eAot3UOIkBECshevDDazLg8FD445pLx/ffsiS9lQUYlUgJIFJLOeoDqPPQMo9mpXRlQePBT0cxxHVO4/ENNnfhFG/y5Hz/XSGTLChuyZHevaF1I4Im52MDlWBYNzQJb5gOt2UUJtEaSlYycca+KxKN8cEXoenqWUmufu4m8bNgunXBaVv++K6Uu/CVvXhfezJicdvbBJqCnFKuLsZDp3MxppmdcEnWQEDAg9R6S7FE+2lAHTVBYESqSEOXjAYQFjY8KxbFGGcK07W2V7lQPYa+z+iZWZP+8X6rooo1X8druwTVNYExN0DuHLi6l0T4V0XIwnV38NnVQnAsuaV1Oev470meJ8VvK2Gks65ZFRKLaE2hEX0xcusQLyVCUj4DUvKFKjCTEDrwl6fdM3QK+H9+i9QMW2xfS58wLymEduvbCha0JpXfsKkZKr1tlY11eUu2QheaWCzeb+QxLCR2MsqHL3Hn0X+patwvxpUBh7fpZr1x5AXhTWv+MyEyAHBBTmoSN8vnTytDRWZhDrIF2nOxNfLG1qCgTaUF5Rvc7AKkfFn1zZ3LQqHT8prMeTojxyS3oPMuqAlowz9h0Qxt5BYR49wYqmz1+UnvZswLNblG+McOgMhEVzyUuySQeKlPMwpQwHiYR72qPvwKrHbp7bXs4zEh0JDoHaHqsSkAUBemY/FJqDEilCQk2kPUXCNkwmpRrv9mcPh8ElsLZ5bduCwJ1kpk2nyiVJ5XipRaln/PCjKF+9DhhPSaUNqSg9vclc0SjdiBNArrh9pws/zsFICoteS1+unEBBDHcmPg4gP49Doe0K5jiR8mL/Lo49kYt+M1eu8nfNVwGrnt67D09TRDRWWBoa5jPF777nUPp7hde8qJyPpXsSAXwccaGXVioSWsp9MoBgnbn8uyAzOJ/dLCDvi1u/k54Og2idzHQ2hKC3DYPTlhDRGysooYCFurCLDBitM4CgRdwIPvacCouqCWtKZYF6bx9VOFHcso2JR4YVd/RzOWZUEAqnUuGsKX6zHSj0S2TqjWADDDKgLgS1psPxJNhJAVXD4radbBjFl7LD3HdQWOMTwi5NM8yEmtrZxbyRIfuDs8U8eEQiU+NPNQR3u7OxJ0noizEJ5RxG/rOHngd5EC6J0Px2hcNUHr1FZVvoG7dwuDj+W3dIr5GWDT2kSsKhzsRiSsO369LQIyLBjcpWOnRUGAO7ZZHx0HGNMw8elg3Irfs2oKdf+c+/5P60RLIhA4A2y1CRhq94hehUtRDRJlKOikcVzvsRJ7gSeghRuiG+DPf1myDtqKycCIsGr72U1RuyhnSQrgep7Ek0pGopXlYtxTILnJk/rknmA1auanjXCHovC9yya5dKTFLiAnVBrpjgCtcNt2e4CPBM4SvFn3EpdpvRAlg1qck5AM2o25m+cLHa4SjP7ZkZWaDAcsoAvW8rG1f555EMA7hgDh7kVCX20//FPuzb/G2NfNlqMxpPt655mWaQaju+EE8GuR0TIQm+/EaHFLNw9HpqQBR3Ki6lE8Mg3ZAwDxwW3h6aA4j1lCFESPPocbkHHEJIHJLpteNz8a6vuR2H0I55/MZwEGtpmQfrRqoDidvBjO8HZJvtknWeJhx90xb5DcJKp8+K6V8vyP/wjVCpW719TGqku2XwTJC71hGJPF8dSPwjGcaldzE2lUEUHsk4M5IZh+NI9dzfjFIyxpRm/vmgYbHn7kjmVLKF0vZ1699aGfSNZP6hdKUcSpe4QylinrP8uas9WVLFbN88wrnFzRtKncPR2AfL5TxYG0pnG8tdI2bqxvJas3JmU+5rt97/Dp01pPISZH64PFi7Gzz1YhJ2LyYIx3sQdmWWi4k968WkdkWru5hMZnKXaRImmaFnuJh490K+I4CY8zFANiNtHvmvZlr9JaUuPN7VDM+HOLsq2tLywjNdzfxGhHyXU0oXZc2aBSgcS/9JKXQjnjQaqhu9G7KbPsaeY1RkcOZVOrsa8p75ctpoSMS9nq+AoKWomDTDoX6/NtwZXzKWUmLFTH4AigfQ1aJDnfGP8N+rtIf2rnDH7sj/XM//A9YbO+2tFAWVAAAAAElFTkSuQmCC\"","module.exports = \"data:image/png;base64,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\"","module.exports = \"data:image/png;base64,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\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAC4jAAAuIwF4pT92AAAFfklEQVR42qWXWWicVRiG/39mUim4NRq88MZWXIpLe+FS6lYKtZsW0UrRUmyllUIXpQiN3hXBC1sxdyom6q2lVRGhUqvFClURUVFUsu+ZmD2TTDKTycTn/fudcPzNJJMaeDOTnHO+7z3ffoLm5uagFFpaWpJ8LmloaAgaGxuD3t7epePj49unpqbeLhQKn4EvwQVwjv+dYm1fOp2u0t76+vqgqampAhmp+XTMqxwB0XcUr8pmsydQ8jPK0oYe0G3f+8AgGGDPn+x9t7+//8HW1taIODKSiyWQ0MGurq4bEKbbjoEZUATTYApMgglDrnDpp2j7hPzk5ORJyN9qJBLlEoiUDw4ObkNIhydQ6JHQ4eHhF1jfgLlXg7v5vn5oaGj3xMTE++xpjZ0ZyWQy+7Fo4Cw6H4GENnLgcExIu/6HRa7XugjOBcno7Oy8EjI7ccVvOstnJIP4OG4kwlIEopuj6JAdlElnuFUtiq/Tmt1ApkwiTJ+hIWF+TmiP9nZ0dChgj/my+LtGJPyYcAHnzL5VfuRAXgfGxsZe1rrWLCOCcuAHMO7agazs1CUWM7KkyYtiwm0OdUuL7KJTLiFAt/VvWQ4SdiYpZbjkCbOEAjhHYN7hLiWWS8QEU7/jfM73Ov3PlAfOrEZoQbi9Zu6UvnOhaic/n89/3dbWFq1FBQNGd7IwbinWiTWuRkjolLe3t1+BKZ8nJV8FRyH4ylxgrVp7RkdHDxIDyxwJXQQZARb4wSxcxCpbpTtiy6E3HTuYHnI+crGB8v2xrFgQEHrLBa0XYxtdvcjlcp9HMcDtr4LZr8Ysze2v8fI11MGBgYFtZqFiGcq1J0+wvWRyQnNnILOj6yfb8zc/VQGp8RR/9Mr8sDppfgtjUR1QcFZBdjN4FGwsAa1tAverDMcKT5Si6HvNKmmGorZbjGrFRqwx9d65Uk4H5a/FIF71nBv6+voesdKt/nEq4NcX1lByKq9+jvoW4OB9NJjHwCawuQS0tgU8jLkTMRKRO3t6em5ReVZ1Bd+KwFfW1bKq7UYgjPWF7ZYhZQchMVDtVc7AlXB0VJpy9YwzInDeCpAI3OUT8LJg72KzgMx6ww9Cj8C1rLeBFkfgrOeC9XEXWPSmRkZGdpCih8EBcLAEDqiXsHePmlI8DswFy9E1rHoDLioIP+JLvyKT4rCrVBBqKvqfQRjaVLXGglA6zyot9lhEFl0Jjqeh0N3dXcXhleA2cHsJaG0lZr7R0vlfWaCeg4WOWhqOkYYvilEVVvjLikMbplsaL0RE9UPms1FDpgRGLcLTuOHZeCFSbUDXBQvoIQrRTa4U17rgIeCe8eIgCkKEHVlsEHK792KlOOQi95j5p2lI56NSLH+x8IAKkRZg+AeNpILDUUuVEKxSiateh+iHoE6jVwnUsf4BqMGyy72OGHVVKu0ZV8656K6oGWl0lmlYPO2l0DFzQcqZ73LghhNL5Z2uV3DJX+iOumRKG1IWnTcrMGxoEMOn3UjtDSTlwO1VO0+Zhe/V9OxGM9J9nbk5FZ8H99nkop1Z0vJJu00YL88LjGSz8YPyNVZpC2bd407nf4ZS+Qlfn/AHSU0ymCv0htKkd9PAS9toZHMTkWSprugizu8E3seSpfiacyy3m4pEjdfbReY7zLbFxqiSY7lLNW69VgOHnXXKT2tSduRKPkwcCQ0U9uqZTS2E/ah+Tmdcp64GKsEysIIYWqsGhKJvrNDMntObQCNZXPmCTzOErkbg2di0U7CUVeHpstdTxpRO+1OTCDNNbXCZFFc+7+PUjdQyO758HJN+apNTxh6iae9xOmBVUBYbhvQ5sug5pdrlPk79B0aFUsleyVUUG/WOT8D39jS/CH7XJ2tH2LNCe60hJRd6nv8Dwj5T3q96iTAAAAAASUVORK5CYII=\""],"sourceRoot":""}